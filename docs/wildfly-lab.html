<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="generator" content="Asciidoctor 1.5.0.preview.1">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>WildFly 8 Hands-on Lab</title>
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
article, aside, details, figcaption, figure, footer, header, hgroup, main, nav, section, summary { display: block; }
audio, canvas, video { display: inline-block; }
audio:not([controls]) { display: none; height: 0; }
[hidden], template { display: none; }
script { display: none !important; }
html { font-family: sans-serif; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; }
body { margin: 0; }
a { background: transparent; }
a:focus { outline: thin dotted; }
a:active, a:hover { outline: 0; }
h1 { font-size: 2em; margin: 0.67em 0; }
abbr[title] { border-bottom: 1px dotted; }
b, strong { font-weight: bold; }
dfn { font-style: italic; }
hr { -moz-box-sizing: content-box; box-sizing: content-box; height: 0; }
mark { background: #ff0; color: #000; }
code, kbd, pre, samp { font-family: monospace, serif; font-size: 1em; }
pre { white-space: pre-wrap; }
q { quotes: "\201C" "\201D" "\2018" "\2019"; }
small { font-size: 80%; }
sub, sup { font-size: 75%; line-height: 0; position: relative; vertical-align: baseline; }
sup { top: -0.5em; }
sub { bottom: -0.25em; }
img { border: 0; }
svg:not(:root) { overflow: hidden; }
figure { margin: 0; }
fieldset { border: 1px solid #c0c0c0; margin: 0 2px; padding: 0.35em 0.625em 0.75em; }
legend { border: 0; padding: 0; }
button, input, select, textarea { font-family: inherit; font-size: 100%; margin: 0; }
button, input { line-height: normal; }
button, select { text-transform: none; }
button, html input[type="button"], input[type="reset"], input[type="submit"] { -webkit-appearance: button; cursor: pointer; }
button[disabled], html input[disabled] { cursor: default; }
input[type="checkbox"], input[type="radio"] { box-sizing: border-box; padding: 0; }
input[type="search"] { -webkit-appearance: textfield; -moz-box-sizing: content-box; -webkit-box-sizing: content-box; box-sizing: content-box; }
input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration { -webkit-appearance: none; }
button::-moz-focus-inner, input::-moz-focus-inner { border: 0; padding: 0; }
textarea { overflow: auto; vertical-align: top; }
table { border-collapse: collapse; border-spacing: 0; }
meta.foundation-mq-small { font-family: "only screen and (min-width: 768px)"; width: 768px; }
meta.foundation-mq-medium { font-family: "only screen and (min-width:1280px)"; width: 1280px; }
meta.foundation-mq-large { font-family: "only screen and (min-width:1440px)"; width: 1440px; }
*, *:before, *:after { -moz-box-sizing: border-box; -webkit-box-sizing: border-box; box-sizing: border-box; }
html, body { font-size: 100%; }
body { background: white; color: #222222; padding: 0; margin: 0; font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; font-weight: normal; font-style: normal; line-height: 1; position: relative; cursor: auto; }
a:hover { cursor: pointer; }
img, object, embed { max-width: 100%; height: auto; }
object, embed { height: 100%; }
img { -ms-interpolation-mode: bicubic; }
#map_canvas img, #map_canvas embed, #map_canvas object, .map_canvas img, .map_canvas embed, .map_canvas object { max-width: none !important; }
.left { float: left !important; }
.right { float: right !important; }
.text-left { text-align: left !important; }
.text-right { text-align: right !important; }
.text-center { text-align: center !important; }
.text-justify { text-align: justify !important; }
.hide { display: none; }
.antialiased, body { -webkit-font-smoothing: antialiased; }
img { display: inline-block; vertical-align: middle; }
textarea { height: auto; min-height: 50px; }
select { width: 100%; }
p.lead, .paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { font-size: 1.21875em; line-height: 1.6; }
.subheader, #content #toctitle, .admonitionblock td.content > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .mathblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, .sidebarblock > .title, .tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title, .tableblock > caption { line-height: 1.4; color: #7a2518; font-weight: 300; margin-top: 0.2em; margin-bottom: 0.5em; }
div, dl, dt, dd, ul, ol, li, h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6, pre, form, p, blockquote, th, td { margin: 0; padding: 0; direction: ltr; }
a { color: #005498; text-decoration: underline; line-height: inherit; }
a:hover, a:focus { color: #00467f; }
a img { border: none; }
p { font-family: inherit; font-weight: normal; font-size: 1em; line-height: 1.6; margin-bottom: 1.25em; text-rendering: optimizeLegibility; }
p aside { font-size: 0.875em; line-height: 1.35; font-style: italic; }
h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { font-family: Georgia, "URW Bookman L", Helvetica, Arial, sans-serif; font-weight: normal; font-style: normal; color: #ba3925; text-rendering: optimizeLegibility; margin-top: 1em; margin-bottom: 0.5em; line-height: 1.2125em; }
h1 small, h2 small, h3 small, #toctitle small, .sidebarblock > .content > .title small, h4 small, h5 small, h6 small { font-size: 60%; color: #e99b8f; line-height: 0; }
h1 { font-size: 2.125em; }
h2 { font-size: 1.6875em; }
h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.375em; }
h4 { font-size: 1.125em; }
h5 { font-size: 1.125em; }
h6 { font-size: 1em; }
hr { border: solid #dddddd; border-width: 1px 0 0; clear: both; margin: 1.25em 0 1.1875em; height: 0; }
em, i { font-style: italic; line-height: inherit; }
strong, b { font-weight: bold; line-height: inherit; }
small { font-size: 60%; line-height: inherit; }
code { font-family: Consolas, "Liberation Mono", Courier, monospace; font-weight: normal; color: #6d180b; }
ul, ol, dl { font-size: 1em; line-height: 1.6; margin-bottom: 1.25em; list-style-position: outside; font-family: inherit; }
ul, ol { margin-left: 1.5em; }
ul.no-bullet, ol.no-bullet { margin-left: 1.5em; }
ul li ul, ul li ol { margin-left: 1.25em; margin-bottom: 0; font-size: 1em; }
ul.square li ul, ul.circle li ul, ul.disc li ul { list-style: inherit; }
ul.square { list-style-type: square; }
ul.circle { list-style-type: circle; }
ul.disc { list-style-type: disc; }
ul.no-bullet { list-style: none; }
ol li ul, ol li ol { margin-left: 1.25em; margin-bottom: 0; }
dl dt { margin-bottom: 0.3125em; font-weight: bold; }
dl dd { margin-bottom: 1.25em; }
abbr, acronym { text-transform: uppercase; font-size: 90%; color: #222222; border-bottom: 1px dotted #dddddd; cursor: help; }
abbr { text-transform: none; }
blockquote { margin: 0 0 1.25em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #dddddd; }
blockquote cite { display: block; font-size: inherit; color: #555555; }
blockquote cite:before { content: "\2014 \0020"; }
blockquote cite a, blockquote cite a:visited { color: #555555; }
blockquote, blockquote p { line-height: 1.6; color: #6f6f6f; }
.vcard { display: inline-block; margin: 0 0 1.25em 0; border: 1px solid #dddddd; padding: 0.625em 0.75em; }
.vcard li { margin: 0; display: block; }
.vcard .fn { font-weight: bold; font-size: 0.9375em; }
.vevent .summary { font-weight: bold; }
.vevent abbr { cursor: auto; text-decoration: none; font-weight: bold; border: none; padding: 0 0.0625em; }
@media only screen and (min-width: 768px) { h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.4; }
  h1 { font-size: 2.75em; }
  h2 { font-size: 2.3125em; }
  h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.6875em; }
  h4 { font-size: 1.4375em; } }
.print-only { display: none !important; }
@media print { * { background: transparent !important; color: #000 !important; box-shadow: none !important; text-shadow: none !important; }
  a, a:visited { text-decoration: underline; }
  a[href]:after { content: " (" attr(href) ")"; }
  abbr[title]:after { content: " (" attr(title) ")"; }
  .ir a:after, a[href^="javascript:"]:after, a[href^="#"]:after { content: ""; }
  pre, blockquote { border: 1px solid #999; page-break-inside: avoid; }
  thead { display: table-header-group; }
  tr, img { page-break-inside: avoid; }
  img { max-width: 100% !important; }
  @page { margin: 0.5cm; }
  p, h2, h3, #toctitle, .sidebarblock > .content > .title { orphans: 3; widows: 3; }
  h2, h3, #toctitle, .sidebarblock > .content > .title { page-break-after: avoid; }
  .hide-on-print { display: none !important; }
  .print-only { display: block !important; }
  .hide-for-print { display: none !important; }
  .show-for-print { display: inherit !important; } }
table { background: white; margin-bottom: 1.25em; border: solid 1px #dddddd; }
table thead, table tfoot { background: whitesmoke; font-weight: bold; }
table thead tr th, table thead tr td, table tfoot tr th, table tfoot tr td { padding: 0.5em 0.625em 0.625em; font-size: inherit; color: #222222; text-align: left; }
table tr th, table tr td { padding: 0.5625em 0.625em; font-size: inherit; color: #222222; }
table tr.even, table tr.alt, table tr:nth-of-type(even) { background: #f9f9f9; }
table thead tr th, table tfoot tr th, table tbody tr td, table tr td, table tfoot tr td { display: table-cell; line-height: 1.6; }
.clearfix:before, .clearfix:after, .float-group:before, .float-group:after { content: " "; display: table; }
.clearfix:after, .float-group:after { clear: both; }
*:not(pre) > code { font-size: 0.9375em; padding: 1px 3px 0; white-space: nowrap; background-color: #f2f2f2; border: 1px solid #cccccc; -webkit-border-radius: 4px; border-radius: 4px; text-shadow: none; }
pre, pre > code { line-height: 1.4; color: inherit; font-family: Consolas, "Liberation Mono", Courier, monospace; font-weight: normal; }
kbd.keyseq { color: #555555; }
kbd:not(.keyseq) { display: inline-block; color: #222222; font-size: 0.75em; line-height: 1.4; background-color: #F7F7F7; border: 1px solid #ccc; -webkit-border-radius: 3px; border-radius: 3px; -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 2px white inset; box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 2px white inset; margin: -0.15em 0.15em 0 0.15em; padding: 0.2em 0.6em 0.2em 0.5em; vertical-align: middle; white-space: nowrap; }
kbd kbd:first-child { margin-left: 0; }
kbd kbd:last-child { margin-right: 0; }
.menuseq, .menu { color: #090909; }
b.button:before { content: '[ '; }
b.button:after { content: ' ]'; }
p a > code:hover { color: #561309; }
#header, #content, #footnotes, #footer { width: 100%; margin-left: auto; margin-right: auto; margin-top: 0; margin-bottom: 0; max-width: 62.5em; *zoom: 1; position: relative; padding-left: 0.9375em; padding-right: 0.9375em; }
#header:before, #header:after, #content:before, #content:after, #footnotes:before, #footnotes:after, #footer:before, #footer:after { content: " "; display: table; }
#header:after, #content:after, #footnotes:after, #footer:after { clear: both; }
#header { margin-bottom: 2.5em; }
#header > h1 { color: black; font-weight: normal; border-bottom: 1px solid #dddddd; margin-bottom: -28px; padding-bottom: 32px; }
#header span { color: #6f6f6f; }
#header #revnumber { text-transform: capitalize; }
#header br { display: none; }
#header br + span { padding-left: 3px; }
#header br + span:before { content: "\2013 \0020"; }
#header br + span.author { padding-left: 0; }
#header br + span.author:before { content: ", "; }
#toc { border-bottom: 3px double #ebebeb; padding-bottom: 1.25em; }
#toc > ul { margin-left: 0.25em; }
#toc ul.sectlevel0 > li > a { font-style: italic; }
#toc ul.sectlevel0 ul.sectlevel1 { margin-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
#toc ul { list-style-type: none; }
#toctitle { color: #7a2518; }
@media only screen and (min-width: 768px) { body.toc2 { padding-left: 15em; padding-right: 0; }
  #toc.toc2 { position: fixed; width: 15em; left: 0; top: 0; border-right: 1px solid #ebebeb; border-bottom: 0; z-index: 1000; padding: 1em; height: 100%; overflow: auto; }
  #toc.toc2 #toctitle { margin-top: 0; font-size: 1.2em; }
  #toc.toc2 > ul { font-size: .90em; }
  #toc.toc2 ul ul { margin-left: 0; padding-left: 1em; }
  #toc.toc2 ul.sectlevel0 ul.sectlevel1 { padding-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 15em; }
  body.toc2.toc-right #toc.toc2 { border-right: 0; border-left: 1px solid #ebebeb; left: auto; right: 0; } }
@media only screen and (min-width: 1280px) { body.toc2 { padding-left: 20em; padding-right: 0; }
  #toc.toc2 { width: 20em; }
  #toc.toc2 #toctitle { font-size: 1.375em; }
  #toc.toc2 > ul { font-size: 0.95em; }
  #toc.toc2 ul ul { padding-left: 1.25em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 20em; } }
#content #toc { border-style: solid; border-width: 1px; border-color: #d9d9d9; margin-bottom: 1.25em; padding: 1.25em; background: #f2f2f2; border-width: 0; -webkit-border-radius: 4px; border-radius: 4px; }
#content #toc > :first-child { margin-top: 0; }
#content #toc > :last-child { margin-bottom: 0; }
#content #toc a { text-decoration: none; }
#content #toctitle { font-weight: bold; font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; font-size: 1em; padding-left: 0.125em; }
#footer { max-width: 100%; background-color: #222222; padding: 1.25em; }
#footer-text { color: #dddddd; line-height: 1.44; }
.sect1 { padding-bottom: 1.25em; }
.sect1 + .sect1 { border-top: 3px double #ebebeb; }
#content h1 > a.anchor, h2 > a.anchor, h3 > a.anchor, #toctitle > a.anchor, .sidebarblock > .content > .title > a.anchor, h4 > a.anchor, h5 > a.anchor, h6 > a.anchor { position: absolute; width: 1em; margin-left: -1em; display: block; text-decoration: none; visibility: hidden; text-align: center; font-weight: normal; }
#content h1 > a.anchor:before, h2 > a.anchor:before, h3 > a.anchor:before, #toctitle > a.anchor:before, .sidebarblock > .content > .title > a.anchor:before, h4 > a.anchor:before, h5 > a.anchor:before, h6 > a.anchor:before { content: '\00A7'; font-size: .85em; vertical-align: text-top; display: block; margin-top: 0.05em; }
#content h1:hover > a.anchor, #content h1 > a.anchor:hover, h2:hover > a.anchor, h2 > a.anchor:hover, h3:hover > a.anchor, #toctitle:hover > a.anchor, .sidebarblock > .content > .title:hover > a.anchor, h3 > a.anchor:hover, #toctitle > a.anchor:hover, .sidebarblock > .content > .title > a.anchor:hover, h4:hover > a.anchor, h4 > a.anchor:hover, h5:hover > a.anchor, h5 > a.anchor:hover, h6:hover > a.anchor, h6 > a.anchor:hover { visibility: visible; }
#content h1 > a.link, h2 > a.link, h3 > a.link, #toctitle > a.link, .sidebarblock > .content > .title > a.link, h4 > a.link, h5 > a.link, h6 > a.link { color: #ba3925; text-decoration: none; }
#content h1 > a.link:hover, h2 > a.link:hover, h3 > a.link:hover, #toctitle > a.link:hover, .sidebarblock > .content > .title > a.link:hover, h4 > a.link:hover, h5 > a.link:hover, h6 > a.link:hover { color: #a53221; }
.imageblock, .literalblock, .listingblock, .mathblock, .verseblock, .videoblock { margin-bottom: 1.25em; }
.admonitionblock td.content > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .mathblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, .sidebarblock > .title, .tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { text-align: left; font-weight: bold; }
.tableblock > caption { text-align: left; font-weight: bold; white-space: nowrap; overflow: visible; max-width: 0; }
table.tableblock #preamble > .sectionbody > .paragraph:first-of-type p { font-size: inherit; }
.admonitionblock > table { border: 0; background: none; width: 100%; }
.admonitionblock > table td.icon { text-align: center; width: 80px; }
.admonitionblock > table td.icon img { max-width: none; }
.admonitionblock > table td.icon .title { font-weight: bold; text-transform: uppercase; }
.admonitionblock > table td.content { padding-left: 1.125em; padding-right: 1.25em; border-left: 1px solid #dddddd; color: #6f6f6f; }
.admonitionblock > table td.content > :last-child > :last-child { margin-bottom: 0; }
.exampleblock > .content { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: white; -webkit-border-radius: 4px; border-radius: 4px; }
.exampleblock > .content > :first-child { margin-top: 0; }
.exampleblock > .content > :last-child { margin-bottom: 0; }
.exampleblock > .content h1, .exampleblock > .content h2, .exampleblock > .content h3, .exampleblock > .content #toctitle, .sidebarblock.exampleblock > .content > .title, .exampleblock > .content h4, .exampleblock > .content h5, .exampleblock > .content h6, .exampleblock > .content p { color: #333333; }
.exampleblock > .content h1, .exampleblock > .content h2, .exampleblock > .content h3, .exampleblock > .content #toctitle, .sidebarblock.exampleblock > .content > .title, .exampleblock > .content h4, .exampleblock > .content h5, .exampleblock > .content h6 { line-height: 1; margin-bottom: 0.625em; }
.exampleblock > .content h1.subheader, .exampleblock > .content h2.subheader, .exampleblock > .content h3.subheader, .exampleblock > .content .subheader#toctitle, .sidebarblock.exampleblock > .content > .subheader.title, .exampleblock > .content h4.subheader, .exampleblock > .content h5.subheader, .exampleblock > .content h6.subheader { line-height: 1.4; }
.exampleblock.result > .content { -webkit-box-shadow: 0 1px 8px #d9d9d9; box-shadow: 0 1px 8px #d9d9d9; }
.sidebarblock { border-style: solid; border-width: 1px; border-color: #d9d9d9; margin-bottom: 1.25em; padding: 1.25em; background: #f2f2f2; -webkit-border-radius: 4px; border-radius: 4px; }
.sidebarblock > :first-child { margin-top: 0; }
.sidebarblock > :last-child { margin-bottom: 0; }
.sidebarblock h1, .sidebarblock h2, .sidebarblock h3, .sidebarblock #toctitle, .sidebarblock > .content > .title, .sidebarblock h4, .sidebarblock h5, .sidebarblock h6, .sidebarblock p { color: #333333; }
.sidebarblock h1, .sidebarblock h2, .sidebarblock h3, .sidebarblock #toctitle, .sidebarblock > .content > .title, .sidebarblock h4, .sidebarblock h5, .sidebarblock h6 { line-height: 1; margin-bottom: 0.625em; }
.sidebarblock h1.subheader, .sidebarblock h2.subheader, .sidebarblock h3.subheader, .sidebarblock .subheader#toctitle, .sidebarblock > .content > .subheader.title, .sidebarblock h4.subheader, .sidebarblock h5.subheader, .sidebarblock h6.subheader { line-height: 1.4; }
.sidebarblock > .content > .title { color: #7a2518; margin-top: 0; line-height: 1.6; }
.exampleblock > .content > :last-child > :last-child, .exampleblock > .content .olist > ol > li:last-child > :last-child, .exampleblock > .content .ulist > ul > li:last-child > :last-child, .exampleblock > .content .qlist > ol > li:last-child > :last-child, .sidebarblock > .content > :last-child > :last-child, .sidebarblock > .content .olist > ol > li:last-child > :last-child, .sidebarblock > .content .ulist > ul > li:last-child > :last-child, .sidebarblock > .content .qlist > ol > li:last-child > :last-child { margin-bottom: 0; }
.literalblock pre:not([class]), .listingblock pre:not([class]) { background: none; }
.literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { border-width: 1px 0; border-style: dotted; border-color: #bfbfbf; -webkit-border-radius: 4px; border-radius: 4px; padding: 0.75em 0.75em 0.5em 0.75em; word-wrap: break-word; }
.literalblock pre.nowrap, .literalblock pre[class].nowrap, .listingblock pre.nowrap, .listingblock pre[class].nowrap { overflow-x: auto; white-space: pre; word-wrap: normal; }
.literalblock pre > code, .literalblock pre[class] > code, .listingblock pre > code, .listingblock pre[class] > code { display: block; }
@media only screen { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 0.8em; } }
@media only screen and (min-width: 768px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 0.9em; } }
@media only screen and (min-width: 1280px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 1em; } }
.listingblock pre.highlight { padding: 0; }
.listingblock pre.highlight > code { padding: 0.75em 0.75em 0.5em 0.75em; }
.listingblock > .content { position: relative; }
.listingblock:hover code[class*=" language-"]:before { text-transform: uppercase; font-size: 0.9em; color: #999; position: absolute; top: 0.375em; right: 0.375em; }
.listingblock:hover code.asciidoc:before { content: "asciidoc"; }
.listingblock:hover code.clojure:before { content: "clojure"; }
.listingblock:hover code.css:before { content: "css"; }
.listingblock:hover code.groovy:before { content: "groovy"; }
.listingblock:hover code.html:before { content: "html"; }
.listingblock:hover code.java:before { content: "java"; }
.listingblock:hover code.javascript:before { content: "javascript"; }
.listingblock:hover code.python:before { content: "python"; }
.listingblock:hover code.ruby:before { content: "ruby"; }
.listingblock:hover code.sass:before { content: "sass"; }
.listingblock:hover code.scss:before { content: "scss"; }
.listingblock:hover code.xml:before { content: "xml"; }
.listingblock:hover code.yaml:before { content: "yaml"; }
.listingblock.terminal pre .command:before { content: attr(data-prompt); padding-right: 0.5em; color: #999; }
.listingblock.terminal pre .command:not([data-prompt]):before { content: '$'; }
table.pyhltable { border: 0; margin-bottom: 0; }
table.pyhltable td { vertical-align: top; padding-top: 0; padding-bottom: 0; }
table.pyhltable td.code { padding-left: .75em; padding-right: 0; }
.highlight.pygments .lineno, table.pyhltable td:not(.code) { color: #999; padding-left: 0; padding-right: .5em; border-right: 1px solid #dddddd; }
.highlight.pygments .lineno { display: inline-block; margin-right: .25em; }
table.pyhltable .linenodiv { background-color: transparent !important; padding-right: 0 !important; }
.quoteblock { margin: 0 0 1.25em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #dddddd; }
.quoteblock blockquote { margin: 0 0 1.25em 0; padding: 0 0 0.5625em 0; border: 0; }
.quoteblock blockquote > .paragraph:last-child p { margin-bottom: 0; }
.quoteblock .attribution { margin-top: -.25em; padding-bottom: 0.5625em; font-size: inherit; color: #555555; }
.quoteblock .attribution br { display: none; }
.quoteblock .attribution cite { display: block; margin-bottom: 0.625em; }
table thead th, table tfoot th { font-weight: bold; }
table.tableblock.grid-all { border-collapse: separate; border-spacing: 1px; -webkit-border-radius: 4px; border-radius: 4px; border-top: 1px solid #dddddd; border-bottom: 1px solid #dddddd; }
table.tableblock.frame-topbot, table.tableblock.frame-none { border-left: 0; border-right: 0; }
table.tableblock.frame-sides, table.tableblock.frame-none { border-top: 0; border-bottom: 0; }
table.tableblock td .paragraph:last-child p > p:last-child, table.tableblock th > p:last-child, table.tableblock td > p:last-child { margin-bottom: 0; }
th.tableblock.halign-left, td.tableblock.halign-left { text-align: left; }
th.tableblock.halign-right, td.tableblock.halign-right { text-align: right; }
th.tableblock.halign-center, td.tableblock.halign-center { text-align: center; }
th.tableblock.valign-top, td.tableblock.valign-top { vertical-align: top; }
th.tableblock.valign-bottom, td.tableblock.valign-bottom { vertical-align: bottom; }
th.tableblock.valign-middle, td.tableblock.valign-middle { vertical-align: middle; }
tbody tr th { display: table-cell; line-height: 1.6; background: whitesmoke; }
tbody tr th, tbody tr th p, tfoot tr th, tfoot tr th p { color: #222222; font-weight: bold; }
td > div.verse { white-space: pre; }
ol { margin-left: 1.75em; }
ul li ol { margin-left: 1.5em; }
dl dd { margin-left: 1.125em; }
dl dd:last-child, dl dd:last-child > :last-child { margin-bottom: 0; }
ol > li p, ul > li p, ul dd, ol dd, .olist .olist, .ulist .ulist, .ulist .olist, .olist .ulist { margin-bottom: 0.625em; }
ul.unstyled, ol.unnumbered, ul.checklist, ul.none { list-style-type: none; }
ul.unstyled, ol.unnumbered, ul.checklist { margin-left: 0.625em; }
ul.checklist li > p:first-child > i[class^="icon-check"]:first-child, ul.checklist li > p:first-child > input[type="checkbox"]:first-child { margin-right: 0.25em; }
ul.checklist li > p:first-child > input[type="checkbox"]:first-child { position: relative; top: 1px; }
ul.inline { margin: 0 auto 0.625em auto; margin-left: -1.375em; margin-right: 0; padding: 0; list-style: none; overflow: hidden; }
ul.inline > li { list-style: none; float: left; margin-left: 1.375em; display: block; }
ul.inline > li > * { display: block; }
.unstyled dl dt { font-weight: normal; font-style: normal; }
ol.arabic { list-style-type: decimal; }
ol.decimal { list-style-type: decimal-leading-zero; }
ol.loweralpha { list-style-type: lower-alpha; }
ol.upperalpha { list-style-type: upper-alpha; }
ol.lowerroman { list-style-type: lower-roman; }
ol.upperroman { list-style-type: upper-roman; }
ol.lowergreek { list-style-type: lower-greek; }
.hdlist > table, .colist > table { border: 0; background: none; }
.hdlist > table > tbody > tr, .colist > table > tbody > tr { background: none; }
td.hdlist1 { padding-right: .8em; font-weight: bold; }
td.hdlist1, td.hdlist2 { vertical-align: top; }
.literalblock + .colist, .listingblock + .colist { margin-top: -0.5em; }
.colist > table tr > td:first-of-type { padding: 0 .8em; line-height: 1; }
.colist > table tr > td:last-of-type { padding: 0.25em 0; }
.qanda > ol > li > p > em:only-child { color: #00467f; }
.thumb, .th { line-height: 0; display: inline-block; border: solid 4px white; -webkit-box-shadow: 0 0 0 1px #dddddd; box-shadow: 0 0 0 1px #dddddd; }
.imageblock.left, .imageblock[style*="float: left"] { margin: 0.25em 0.625em 1.25em 0; }
.imageblock.right, .imageblock[style*="float: right"] { margin: 0.25em 0 1.25em 0.625em; }
.imageblock > .title { margin-bottom: 0; }
.imageblock.thumb, .imageblock.th { border-width: 6px; }
.imageblock.thumb > .title, .imageblock.th > .title { padding: 0 0.125em; }
.image.left, .image.right { margin-top: 0.25em; margin-bottom: 0.25em; display: inline-block; line-height: 0; }
.image.left { margin-right: 0.625em; }
.image.right { margin-left: 0.625em; }
a.image { text-decoration: none; }
span.footnote, span.footnoteref { vertical-align: super; font-size: 0.875em; }
span.footnote a, span.footnoteref a { text-decoration: none; }
#footnotes { padding-top: 0.75em; padding-bottom: 0.75em; margin-bottom: 0.625em; }
#footnotes hr { width: 20%; min-width: 6.25em; margin: -.25em 0 .75em 0; border-width: 1px 0 0 0; }
#footnotes .footnote { padding: 0 0.375em; line-height: 1.3; font-size: 0.875em; margin-left: 1.2em; text-indent: -1.2em; margin-bottom: .2em; }
#footnotes .footnote a:first-of-type { font-weight: bold; text-decoration: none; }
#footnotes .footnote:last-of-type { margin-bottom: 0; }
#content #footnotes { margin-top: -0.625em; margin-bottom: 0; padding: 0.75em 0; }
.gist .file-data > table { border: none; background: #fff; width: 100%; margin-bottom: 0; }
.gist .file-data > table td.line-data { width: 99%; }
div.unbreakable { page-break-inside: avoid; }
.big { font-size: larger; }
.small { font-size: smaller; }
.underline { text-decoration: underline; }
.overline { text-decoration: overline; }
.line-through { text-decoration: line-through; }
.aqua { color: #00bfbf; }
.aqua-background { background-color: #00fafa; }
.black { color: black; }
.black-background { background-color: black; }
.blue { color: #0000bf; }
.blue-background { background-color: #0000fa; }
.fuchsia { color: #bf00bf; }
.fuchsia-background { background-color: #fa00fa; }
.gray { color: #606060; }
.gray-background { background-color: #7d7d7d; }
.green { color: #006000; }
.green-background { background-color: #007d00; }
.lime { color: #00bf00; }
.lime-background { background-color: #00fa00; }
.maroon { color: #600000; }
.maroon-background { background-color: #7d0000; }
.navy { color: #000060; }
.navy-background { background-color: #00007d; }
.olive { color: #606000; }
.olive-background { background-color: #7d7d00; }
.purple { color: #600060; }
.purple-background { background-color: #7d007d; }
.red { color: #bf0000; }
.red-background { background-color: #fa0000; }
.silver { color: #909090; }
.silver-background { background-color: #bcbcbc; }
.teal { color: #006060; }
.teal-background { background-color: #007d7d; }
.white { color: #bfbfbf; }
.white-background { background-color: #fafafa; }
.yellow { color: #bfbf00; }
.yellow-background { background-color: #fafa00; }
span.icon > [class^="icon-"], span.icon > [class*=" icon-"] { cursor: default; }
.admonitionblock td.icon [class^="icon-"]:before { font-size: 2.5em; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5); cursor: default; }
.admonitionblock td.icon .icon-note:before { content: "\f05a"; color: #005498; color: #003f72; }
.admonitionblock td.icon .icon-tip:before { content: "\f0eb"; text-shadow: 1px 1px 2px rgba(155, 155, 0, 0.8); color: #111; }
.admonitionblock td.icon .icon-warning:before { content: "\f071"; color: #bf6900; }
.admonitionblock td.icon .icon-caution:before { content: "\f06d"; color: #bf3400; }
.admonitionblock td.icon .icon-important:before { content: "\f06a"; color: #bf0000; }
.conum { display: inline-block; color: white !important; background-color: #222222; -webkit-border-radius: 100px; border-radius: 100px; text-align: center; width: 20px; height: 20px; font-size: 12px; font-weight: bold; line-height: 20px; font-family: Arial, sans-serif; font-style: normal; position: relative; top: -2px; letter-spacing: -1px; }
.conum * { color: white !important; }
.conum + b { display: none; }
.conum:after { content: attr(data-value); }
.conum:not([data-value]):empty { display: none; }
.literalblock > .content > pre, .listingblock > .content > pre { -webkit-border-radius: 0; border-radius: 0; }

</style>
</head>
<body class="article">
<div id="header">
<h1>WildFly 8 Hands-on Lab</h1>
<span id="author" class="author">Arun Gupta</span><br>
<span id="revnumber">version 1.0,</span>
<span id="revdate">Jan 28, 2014</span>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_introduction">1. Introduction</a></li>
<li>
<ul class="sectlevel2">
<li><a href="#_getting_started">1.1. Getting Started</a></li>
<li>
<ul class="sectlevel3">
<li><a href="#_standalone_and_managed_domain">1.1.1. Standalone and Managed Domain</a></li>
<li><a href="#_web_profile_and_full_platform">1.1.2. Web Profile and Full Platform</a></li>
<li><a href="#_multiple_instances_on_the_same_machine">1.1.3. Multiple instances on the same machine</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_deploying_applications_to_wildfly">2. Deploying Applications to WildFly</a></li>
<li>
<ul class="sectlevel2">
<li><a href="#_file_system">2.1. File system</a></li>
<li><a href="#_administration_console">2.2. Administration Console</a></li>
<li><a href="#_command_line_interface_jboss_cli">2.3. Command Line Interface (jboss-cli)</a></li>
<li>
<ul class="sectlevel3">
<li><a href="#_interactive">2.3.1. Interactive</a></li>
<li><a href="#_non_interactive">2.3.2. Non-interactive</a></li>
</ul>
</li>
<li><a href="#_curl">2.4. Curl</a></li>
<li><a href="#_maven_plugin">2.5. Maven plugin</a></li>
<li><a href="#_java">2.6. Java</a></li>
<li><a href="#_ruby_tbd">2.7. Ruby (TBD)</a></li>
<li><a href="#_perl_tbd">2.8. Perl (TBD)</a></li>
</ul>
</li>
<li><a href="#jboss-cli">3. Management using Command Line Interface (jboss-cli)</a></li>
<li>
<ul class="sectlevel2">
<li><a href="#_connecting_to_a_server">3.1. Connecting to a server</a></li>
<li><a href="#_resources_operations_and_commands">3.2. Resources, Operations, and Commands</a></li>
<li>
<ul class="sectlevel3">
<li><a href="#_operations">3.2.1. Operations</a></li>
<li><a href="#_commands">3.2.2. Commands</a></li>
</ul>
</li>
<li><a href="#_batch">3.3. Batch</a></li>
<li>
<ul class="sectlevel3">
<li><a href="#_interactive_batch">3.3.1. Interactive Batch</a></li>
<li><a href="#_non_interactive_batch">3.3.2. Non-interactive Batch</a></li>
</ul>
</li>
<li><a href="#_environment_variables">3.4. Environment variables</a></li>
<li>
<ul class="sectlevel3">
<li><a href="#_non_persistent_variables">3.4.1. Non-persistent Variables</a></li>
<li><a href="#_persistent_variables">3.4.2. Persistent Variables</a></li>
</ul>
</li>
<li><a href="#_gui">3.5. GUI</a></li>
</ul>
</li>
<li><a href="#_role_based_access_control">4. Role Based Access Control</a></li>
<li>
<ul class="sectlevel2">
<li><a href="#_default_super_user">4.1. Default super user</a></li>
<li><a href="#_configure_rbac_access_control_provider">4.2. Configure &#8216;rbac&#8217; access control provider</a></li>
<li><a href="#_map_users_groups_and_roles">4.3. Map users, groups, and roles</a></li>
<li><a href="#_logging_in_as_different_users">4.4. Logging in as different users</a></li>
<li><a href="#_filtering_out_commands_in_jboss_cli">4.5. Filtering out commands in &#8216;jboss-cli&#8217;</a></li>
</ul>
</li>
<li><a href="#_audit_logging">5. Audit Logging</a></li>
<li>
<ul class="sectlevel2">
<li><a href="#_turn_on_audit_logging">5.1. Turn on audit logging</a></li>
<li><a href="#_logging_json_records_to_file">5.2. Logging JSON records to file</a></li>
</ul>
</li>
<li><a href="#_acknowledgements">6. Acknowledgements</a></li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_introduction">1. Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>WildFly 8 (nee JBoss Application Server 7) is a lightweight, flexible, Java EE 7 compliant, polyglot, and open source application server.</p>
</div>
<div class="paragraph">
<p>This self-paced hands-on lab introduces the basic administrative features of WildFly 8. A comprehensive lab that covers Java EE 7 development using WildFly is available at: <a href="https://github.com/javaee-samples/javaee7-hol">https://github.com/javaee-samples/javaee7-hol</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This document is a work in progress. The latest version of this document is available at <a href="http://github.com/arun-gupta/wildfly-lab">http://github.com/arun-gupta/wildfly-lab</a>. Please send pull requests to contribute or file issues.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_getting_started">1.1. Getting Started</h3>
<div class="paragraph">
<p>Download the WildFly 8 &#8216;Application Server Distribution&#8217; zip file from <a href="http://wildfly.org/downloads/">http://wildfly.org/downloads/</a> and unzip.</p>
</div>
<div class="paragraph">
<p>Lets get familiar with the directory structure.</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 100%;">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Directory</th>
<th class="tableblock halign-left valign-top">Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">appclient</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configuration files, deployment content, log files, and writeable areas used by the application client from this installation</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">bin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Startup scripts, startup configuration files and other command line utilities</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">docs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">XML Schema definition files and sample configurations</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">domain</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configuration files, deployment content, log files, and writeable areas used by the managed domain from this installation</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">domain/lib/ext</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Directory for installed library jars referenced by applications using the Extension-List mechanism for this domain</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">domain/servers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Writable area for each application server instance that runs in this domain. Each server has its own directory., created when the server is started.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">modules</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Various modules used in the server</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">standalone</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configuration files, deployment content, log files, and writeable areas used by the single standalone server from this installation</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">standalone/deployments</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Directory for filesystem-based automatic deployment</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">standalone/lib/ext</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Directory for installed library jars referenced by applications using the Extension-List mechanism for this instance</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">welcome-content</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default welcome page content</p></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="_standalone_and_managed_domain">1.1.1. Standalone and Managed Domain</h4>
<div class="paragraph">
<p>WildFly 8 can be started in two different modes:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>A <em>standalone</em> server is an independent instance. It can be started using <code>bin/standalone.sh</code> launch script on Unix-variety of machines and <code>bin/standalone.bat</code> on Windows.</p>
</li>
<li>
<p>A <em>managed domain</em> that allows you to run and manage a multi-server topology and manage multiple WildFly instances from a single control point. It can be started using <code>bin/domain.sh</code> launch script on Unix-variety of machines and <code>bin/domain.bat</code> on Windows.</p>
<div class="paragraph">
<p>A Domain Controller is the central management control point for the collection of servers in the &#8216;domain&#8217;. More details about starting WildFly in managed domain mode, server topology and central management is explained in <a href="#clustering">[clustering]</a>.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_web_profile_and_full_platform">1.1.2. Web Profile and Full Platform</h4>
<div class="paragraph">
<p>Java EE defines <em>profiles</em> that represent a configuration of the full platform suited to a particular class of applications. The Java EE Web Profile is defined as a separate specification in the platform, and is defined as a subset of technologies contained in the platform and targeted toward the developers of modern web applications.</p>
</div>
<div class="paragraph">
<p>WildFly supports both Web Profile and Full Platform by defining &#8220;configuration profiles&#8221; in different files. These profiles are defined in <code>standalone/configuration/*.xml</code> files for standalone instance and <code>domain/configuration/domain.xml</code> for managed domain.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Start a WildFly instance in web profile</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>./bin/standalone.sh</code></pre>
</div>
</div>
<div class="paragraph">
<p>This starts WildFly standalone instance server in web profile. By default it refers to <code>standalone\configuration\standalone.xml</code> configuration file which offers more capabilities than just web profile.</p>
</div>
<div class="paragraph">
<p>Access <a href="http://localhost:8080">http://localhost:8080</a> and see the following page to make sure the server is running correctly.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/intro-wildfly-welcome.png" alt="intro wildfly welcome">
</div>
<div class="title">Figure 1. WildFly welcome screen</div>
</div>
<div class="paragraph">
<p>Use Ctrl+C to stop the running server.</p>
</div>
</li>
<li>
<p>Start WildFly in full platform by specifying the configuration as:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>./bin/standalone.sh -c standalone-full.xml</code></pre>
</div>
</div>
<div class="paragraph">
<p>The name of the configuration file, without <code>.xml</code> suffix, from &#8216;standalone/configuration&#8217; directory is specified as the parameter.</p>
</div>
<div class="paragraph">
<p>Use Ctrl+C to stop the running server.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_multiple_instances_on_the_same_machine">1.1.3. Multiple instances on the same machine</h4>
<div class="paragraph">
<p>Multiple instances of standalone server can be started on the same machine by specifying a port offset option to the <code>standalone.sh</code> or <code>standalone.bat</code> script.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Start another instance of standalone server at port 9080 using the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>./bin/standalone.sh -Djboss.socket.binding.port-offset=1000</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will start another standalone instance server on port 9080 (=8080 + 1000) as the default application port and 10990 (=9990 + 1000) as the default management port. These port numbers would differ if non-default ports were used.</p>
</div>
<div class="paragraph">
<p>After the server is stated the welcome page is now accessible at <a href="http://localhost:9080">http://localhost:9080</a>.</p>
</div>
<div class="paragraph">
<p>Use Ctrl+C to stop the running server.</p>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_deploying_applications_to_wildfly">2. Deploying Applications to WildFly</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Purpose</strong>: This section explains different ways to deploy Java EE 7 applications to WildFly.</p>
</div>
<div class="paragraph">
<p>Make sure to start a WildFly standalone instance for each sub-section unless stated otherwise. A standalone instance can be started as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>standalone.sh</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_file_system">2.1. File system</h3>
<div class="paragraph">
<p>Deploying archives such as war, ear, and rar files using file system is as simple as copying to <code>standalone/deployments</code> directory. The deployment can be configured for auto-deploy or manual mode.</p>
</div>
<div class="paragraph">
<p>Any archive can be placed in <code>standalone/deployments</code> directory and is automatically deployed to the server. This is the default behavior.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<div class="title">Caution</div>
</td>
<td class="content">
This deployment mode is only intended to be used during development phase. Managed domain mode is recommended if running production systems.
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clone the github repo by giving the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>git clone https://github.com/arun-gupta/wildfly-lab.git</code></pre>
</div>
</div>
</li>
<li>
<p>Change directory to <code>samples/javaee7</code> and build the sample as:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>mvn install</code></pre>
</div>
</div>
</li>
<li>
<p>Copy the war file to <code>standalone/deployments</code> directory using the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>cp target/javaee7-1.0-SNAPSHOT.war /Users/arungupta/workspaces/wildfly/build/target/wildfly-8.0.0.Final-SNAPSHOT/standalone/deployments</code></pre>
</div>
</div>
<div class="paragraph">
<p>Make sure to change the directory name to match your filesystem.</p>
</div>
</li>
<li>
<p>Verify the deployed application by accessing the webpage <a href="http://localhost:8080/javaee7-1.0-SNAPSHOT/EmployeeList">http://localhost:8080/javaee7-1.0-SNAPSHOT/EmployeeList</a> and see the output as:</p>
<div class="imageblock">
<div class="content">
<img src="images/deploy-javaee7-sample-output.png" alt="deploy javaee7 sample output">
</div>
<div class="title">Figure 2. Java EE 7 sample application output</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_administration_console">2.2. Administration Console</h3>
<div class="paragraph">
<p>The Admin Console is a web-based administration console and available at <a href="http://localhost:9990/console">http://localhost:9990/console</a>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>A new user in the management realm needs to be added before the admin console can be accessed.</p>
<div class="paragraph">
<p>A new user can be added in the management realm using <code>add-user.sh</code> script. This can be done non-interactively by giving the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>add-user.sh -u sheldon -p bazinga</code></pre>
</div>
</div>
<div class="paragraph">
<p>The output of the command looks like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>Added user 'sheldon' to file '/Users/arungupta/workspaces/wildfly/build/target/wildfly-8.0.0.Final-SNAPSHOT/standalone/configuration/mgmt-users.properties'
Added user 'sheldon' to file '/Users/arungupta/workspaces/wildfly/build/target/wildfly-8.0.0.Final-SNAPSHOT/domain/configuration/mgmt-users.properties'</code></pre>
</div>
</div>
<div class="paragraph">
<p>The directory names &#8216;standalone&#8217; and &#8216;domain&#8217; indicate that the user is added to both standalone instance and managed domain. The file name indicates that it is added to the management realm.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
A user can be added to application realm by including <code>-a</code> switch.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Alternatively, the user can be added interactively by invoking the script and entering the values on the prompt as shown:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>add-user.sh

What type of user do you wish to add?
 a) Management User (mgmt-users.properties)
 b) Application User (application-users.properties)
(a): &lt;take default&gt;

Enter the details of the new user to add.
Using realm 'ManagementRealm' as discovered from the existing property files.
Username : &lt;sheldon&gt;
Password requirements are listed below. To modify these restrictions edit the add-user.properties configuration file.
 - The password must not be one of the following restricted values {root, admin, administrator}
 - The password must contain at least 8 characters, 1 alphanumeric character(s), 1 digit(s), 1 non-alphanumeric symbol(s)
 - The password must be different from the username
Password : &lt;bazinga&gt;
JBAS015269: Password must have at least 8 characters!
Are you sure you want to use the password entered yes/no? &lt;yes&gt;
Re-enter Password : &lt;bazinga&gt;
What groups do you want this user to belong to? (Please enter a comma separated list, or leave blank for none)[  ]:
About to add user 'sheldon' for realm 'ManagementRealm'
Is this correct yes/no? &lt;yes&gt;
Added user 'sheldon' to file '/Users/arungupta/workspaces/wildfly/build/target/wildfly-8.0.0.Final-SNAPSHOT/standalone/configuration/mgmt-users.properties'
Added user 'sheldon' to file '/Users/arungupta/workspaces/wildfly/build/target/wildfly-8.0.0.Final-SNAPSHOT/domain/configuration/mgmt-users.properties'
Added user 'sheldon' with groups  to file '/Users/arungupta/workspaces/wildfly/build/target/wildfly-8.0.0.Final-SNAPSHOT/standalone/configuration/mgmt-groups.properties'
Added user 'sheldon' with groups  to file '/Users/arungupta/workspaces/wildfly/build/target/wildfly-8.0.0.Final-SNAPSHOT/domain/configuration/mgmt-groups.properties'
Is this new user going to be used for one AS process to connect to another AS process?
e.g. for a slave host controller connecting to the master or for a Remoting connection for server to server EJB calls.
yes/no? &lt;no&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now accessing the console at <a href="http://localhost:9990/console">http://localhost:9990/console</a> prompts for a username and password. Enter the username &#8216;sheldon&#8217; and password &#8216;bazinga&#8217; and then the console is shown as:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/deploy-admin-console.png" alt="deploy admin console">
</div>
<div class="title">Figure 3. Admin console</div>
</div>
<div class="paragraph">
<p>The added user can be disabled by giving the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>add-user.sh -u sheldon -d</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
User can be deleted by deleting the corresponding line from <code>domain/configuration/mgmt-users.properties</code> and <code>standalone/configuration/mgmt-users.properties</code> files.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Click on &#8216;Manage Deployments&#8217; to see the output as:</p>
<div class="imageblock">
<div class="content">
<img src="images/deploy-admin-console-deployments-first.png" alt="deploy admin console deployments first">
</div>
<div class="title">Figure 4. Admin console deployments</div>
</div>
</li>
<li>
<p>Click on &#8216;Add&#8217; button to see:</p>
<div class="imageblock">
<div class="content">
<img src="images/deploy-admin-console-add-first.png" alt="deploy admin console add first">
</div>
<div class="title">Figure 5. Add a deployment</div>
</div>
</li>
<li>
<p>Click on &#8216;Choose File&#8217; button and select the war file.</p>
<div class="paragraph">
<p>Click on &#8216;Next &gt;&gt;&#8217; button. Take the defaults and click &#8216;Save&#8217;.</p>
</div>
</li>
<li>
<p>By default the application is not enabled and the console shows:</p>
<div class="imageblock">
<div class="content">
<img src="images/deploy-enable-disable-app.png" alt="deploy enable disable app">
</div>
<div class="title">Figure 6. En/Disable button</div>
</div>
<div class="paragraph">
<p>Click on &#8216;En/Disable&#8217; button, click on &#8216;Confirm&#8217; and now the app is ready to be used. Access the application <a href="http://localhost:8080/javaee7-1.0-SNAPSHOT.war/EmployeeList">http://localhost:8080/javaee7-1.0-SNAPSHOT.war/EmployeeList</a>.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_command_line_interface_jboss_cli">2.3. Command Line Interface (jboss-cli)</h3>
<div class="paragraph">
<p><code>jboss-cli.sh</code> or <code>jboss-cli.bat</code> is Command Line Interface management tool for a standalone server or a managed domain. It allows a user to connect to a standalone server or domain controller and execute management operations.</p>
</div>
<div class="paragraph">
<p>More details about using jboss-cli for managing the server are available in <a href="#jboss-cli">Management using Command Line Interface (jboss-cli)</a>.</p>
</div>
<div class="paragraph">
<p>&#8216;jboss-cli&#8217; can be used to deploy applications using the interactive console or in a non-interactive manner.</p>
</div>
<div class="sect3">
<h4 id="_interactive">2.3.1. Interactive</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Use jboss-cli to connect with the existing standalone instance by giving the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>jboss-cli.sh -c</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>-c</code> switch connects using the default host (&#8216;localhost&#8217;) and management port (&#8216;9990&#8217;). These values are specified in &#8216;jboss-cli.xml&#8217; and can be updated.</p>
</div>
<div class="paragraph">
<p>This opens up the &#8216;jboss-cli&#8217; interactive console and shows the following prompt:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>[standalone@localhost:9990 /]</code></pre>
</div>
</div>
<div class="paragraph">
<p>The prompt indicates that &#8216;jboss-cli&#8217; is connected to a standalone instance&#8217;s management port.</p>
</div>
</li>
<li>
<p>Deploy the application by giving the following command in console:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>deploy target/javaee7-1.0-SNAPSHOT.war</code></pre>
</div>
</div>
<div class="paragraph">
<p>The directory name of the war file in the command may be different depending upon how &#8216;jboss-cli&#8217; was invoked. Verify the server log to ensure that the application was redeployed. Look for specific timestamp in the log entries.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<code>--force</code> switch can be included in the command to replace the existing application.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Verify the deployment status by typing the following command <code>deployment-info</code> in the console:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>deployment-info</code></pre>
</div>
</div>
<div class="paragraph">
<p>and see the output as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>NAME                     RUNTIME-NAME             PERSISTENT ENABLED STATUS
javaee7-1.0-SNAPSHOT.war javaee7-1.0-SNAPSHOT.war true       true    OK</code></pre>
</div>
</div>
<div class="paragraph">
<p>Verify the server log to ensure that the application was deployed. Look for specific timestamp in the log entries.</p>
</div>
</li>
<li>
<p>Undeploy the application by giving the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>undeploy javaee7-1.0-SNAPSHOT.war</code></pre>
</div>
</div>
</li>
<li>
<p>Type <code>exit</code> &#8216;quit&#8217; to exit &#8216;jboss-cli&#8217; interactive console.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_non_interactive">2.3.2. Non-interactive</h4>
<div class="paragraph">
<p>Non-interactive mode allows to support scripts and other types of command line or batch processing.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Deploy the application using the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>jboss-cli.sh --connect --command="deploy target/javaee7-1.0-SNAPSHOT.war --force"</code></pre>
</div>
</div>
<div class="paragraph">
<p>The directory name of the war file in the command may be different depending upon how &#8216;jboss-cli&#8217; was invoked. Verify the server log to ensure that the application was redeployed. Look for specific timestamp in the log entries.</p>
</div>
<div class="paragraph">
<p>Verify the deployed application at <a href="http://localhost:8080/javaee7/EmployeeList">http://localhost:8080/javaee7/EmployeeList</a> and look for a similar output.</p>
</div>
</li>
<li>
<p>Verify the deployment status by giving the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>jboss-cli.sh --connect --command=deployment-info</code></pre>
</div>
</div>
</li>
<li>
<p>Undeploy the application by giving the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>jboss-cli.sh --connect --command="undeploy javaee7-1.0-SNAPSHOT.war"</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_curl">2.4. Curl</h3>
<div class="paragraph">
<p>curl is a free and popular command line tool for transfering data using URL syntax. If you don&#8217;t have it installed on your machine then it can be downloaded from <a href="http://curl.haxx.se/download.html">http://curl.haxx.se/download.html</a>.</p>
</div>
<div class="paragraph">
<p>Deploying applications using curl is a two-step process.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Upload your archive to WildFly using the following command</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>curl -F "file=@target/javaee7-1.0-SNAPSHOT.war" --digest http://sheldon:bazinga@localhost:9990/management/add-content</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Makes a POST request using form-encoded (<code>-F</code>) data with one field (<code>file</code>) defining location of the WAR file</p>
</li>
<li>
<p><code>target/javaee7-1.0-SNAPSHOT.war</code> is location of the WAR file</p>
</li>
<li>
<p><code>sheldon</code> is a user with administrative privileges and password <code>bazinga</code></p>
</li>
<li>
<p><code>localhost:9090</code> is the default management host and port for WildFly instance</p>
</li>
<li>
<p>WildFly management port uses digest authentication and that is defined using <code>–digest</code></p>
</li>
<li>
<p>Prints the output as something like:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>{“outcome” : “success”, “result” : { “BYTES_VALUE” : “+Dg9u1ALXacrndNdLrT3DQSaqjw=” }}</code></pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Deploy the uploaded archive using the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>curl -S -H "Content-Type: application/json" -d '{"content":[{"hash": {"BYTES_VALUE" : "+Dg9u1ALXacrndNdLrT3DQSaqjw="}}], "address": [{"deployment":"javaee7-1.0-SNAPSHOT.war"}], "operation":"add", "enabled":"true"}' --digest http://sheldon:bazinga@localhost:9990/management</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Sends a POST request (<code>-d</code>) with JSON payload</p>
</li>
<li>
<p>Value assigned to <code>result</code> name in the JSON response of previous command is assigned to <code>hash</code> name in this command</p>
</li>
<li>
<p>Content type of the payload is explicitly specified to be <code>application/json</code> using <code>-H</code></p>
</li>
<li>
<p><code>add</code> command triggers the deployment of the archive</p>
</li>
<li>
<p>Application archive is enabled as well, as opposed to not by default</p>
</li>
<li>
<p>As in previous command, <code>sheldon</code> is the administrative user with password <code>bazinga</code></p>
</li>
<li>
<p>As in previous command, <code>localhost:9090</code> is the default management host and port for WildFly instance</p>
</li>
<li>
<p>As in previous command, WildFly management port uses digest authentication and that is defined using <code>–digest</code></p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_maven_plugin">2.5. Maven plugin</h3>
<div class="paragraph">
<p>The wildfly-maven-plugin is used to deploy, redeploy, undeploy or run your application. You can also deploy or undeploy artifacts, such as JDBC drivers, and add or remove resources. There is also the ability to execute CLI commands.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Note that <code>samples/javaee7/pom.xml</code> contains the following fragment:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="xml language-xml">&lt;plugin&gt;
    &lt;groupId&gt;org.wildfly.plugins&lt;/groupId&gt;
    &lt;artifactId&gt;wildfly-maven-plugin&lt;/artifactId&gt;
    &lt;version&gt;1.0.0.Beta1&lt;/version&gt;
    &lt;executions&gt;
        &lt;execution&gt;
            &lt;phase&gt;install&lt;/phase&gt;
            &lt;goals&gt;
                &lt;goal&gt;deploy&lt;/goal&gt;
            &lt;/goals&gt;
        &lt;/execution&gt;
    &lt;/executions&gt;
&lt;/plugin&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This specifies the &#8216;wildfly-maven-plugin&#8217; description to &#8216;pom.xml&#8217;. It also invokes the plugin &#8216;deploy&#8217; target during the standard maven &#8216;install&#8217; phase.</p>
</div>
</li>
<li>
<p>Start a WildFly instance as:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>standalone.sh</code></pre>
</div>
</div>
</li>
<li>
<p>Deploy the application by giving the command:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>mvn wildfly:deploy</code></pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>mvn install</code></pre>
</div>
</div>
</li>
<li>
<p>Access the web page at <a href="http://localhost:8080/javaee7/EmployeeList">http://localhost:8080/javaee7/EmployeeList</a> and see the output as:</p>
<div class="imageblock">
<div class="content">
<img src="images/deploy-javaee7-sample-output.png" alt="deploy javaee7 sample output">
</div>
<div class="title">Figure 7. Java EE 7 sample application output</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_java">2.6. Java</h3>
<div class="paragraph">
<p>A standalone WildFly process or a managed domain can be configured to listen for remote management requests using its &#8220;native management interface&#8221;. This interface uses an open protocol based on the JBoss Remoting library. JBoss Remoting is used to establish a communication channel from the client to the process being managed. Once the communication channel is established the primary traffic over the channel is management requests initiated by the client and asynchronous responses from the target process.</p>
</div>
<div class="paragraph">
<p>Deployment using a custom Java class is a two-step process:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>First step is to build a deployment plan that describe the steps of uploading the archive to the content repository and deploying it.</p>
</li>
<li>
<p>Second step involves executing the deployment plan on the application server instance.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Lets create an application that will allow us to deploy a Java EE 7 application using a Java-based class.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a maven project as:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>mvn archetype:generate -DarchetypeGroupId=org.apache.maven.archetypes -DgroupId=org.wildfly.samples -DartifactId=deployment -DinteractiveMode=false</code></pre>
</div>
</div>
</li>
<li>
<p>Open the created Maven project in NetBeans, Eclipse, IntelliJ or any other editor of your choice. The custom client must have maven artifact &#8216;org.jboss.as:jboss-as-controller-client&#8217; and its dependencies on the classpath. &#8216;org.jboss:jboss-dmr&#8217; is maven artifact for detyped representation of the management model and must be added to the list of maven dependencies as well.</p>
<div class="paragraph">
<p>This can be achieved by adding the following dependencies in <code>pom.xml</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&lt;dependency&gt;
    &lt;groupId&gt;org.jboss.as&lt;/groupId&gt;
    &lt;artifactId&gt;jboss-as-controller-client&lt;/artifactId&gt;
    &lt;version&gt;7.2.0.Final&lt;/version&gt;
    &lt;scope&gt;test&lt;/scope&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.jboss&lt;/groupId&gt;
    &lt;artifactId&gt;jboss-dmr&lt;/artifactId&gt;
    &lt;version&gt;1.2.0.Final&lt;/version&gt;
    &lt;scope&gt;test&lt;/scope&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that both the dependencies are added in &#8216;test&#8217; scope.</p>
</div>
</li>
<li>
<p>Edit the <code>src/test/java/org/wildfly/samples/AppTest.java</code> file and add a method as shown:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>ModelControllerClient createClient(final InetAddress host, final int port,
            final String username, final String password) {

   final CallbackHandler callbackHandler = new CallbackHandler() {

       @Override
       public void handle(Callback[] callbacks) throws IOException, UnsupportedCallbackException {
           for (Callback current : callbacks) {
               if (current instanceof NameCallback) {
                   NameCallback ncb = (NameCallback) current;
                   ncb.setName(username);
               } else if (current instanceof PasswordCallback) {
                   PasswordCallback pcb = (PasswordCallback) current;
                   pcb.setPassword(password.toCharArray());
               } else {
                   throw new UnsupportedCallbackException(current);
               }
           }
       }
    };

    return ModelControllerClient.Factory.create(host, port, callbackHandler);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this code:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><code>ModelControllerClient</code> is used to manage a WildFly server instance or a Domain Controller or slave Host Controller.</p>
</li>
<li>
<p>A new instance is created by specifying host, port, and a Callback handler to obtain authentication information for the call. Typically these credentials are obtained from a dialog box, such as a GUI-base client. In our case the credentials will be passed when this method is invoked.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Update <code>testApp</code> method such that it looks like:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>public void testApp() throws IOException, InterruptedException, ExecutionException {
    // create client
    ModelControllerClient client = createClient(InetAddress.getByName("localhost"),
        9999,
        "sheldon",
        "bazinga");

    // connect
    ServerDeploymentManager manager = ServerDeploymentManager.Factory.create(client);

    // build a deployment plan
    DeploymentPlan plan = manager
        .newDeploymentPlan()
        .add(new File("/Users/arungupta/workspaces/wildfly-lab/samples/javaee7/target/javaee7-1.0-SNAPSHOT.war"))
        .andDeploy()
        .build();

    // run it
    ServerDeploymentPlanResult result = manager.execute(plan).get();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Make sure to resolve imports from <code>org.jboss.as.controller.client.helpers.standalone.*</code> package. Also change the directory name to match your filesystem.</p>
</div>
<div class="paragraph">
<p>In this code:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>A new instance of client for controlling application server management model is created by specifying the correct host, port, username, and password. Note that the username and password are the ones specified earlier.</p>
</li>
<li>
<p><code>ServerDeploymentManager</code> is the primary deployment interface for a standalone instance. A new instance is created by using the previously created <code>ModelControllerClient</code>.</p>
</li>
<li>
<p><code>newDeploymentPlan</code> initiates the creation of a new <code>DeploymentPlan</code>. Archive is added to the repository using <code>add</code> method and deployed using <code>andDeploy</code> method. Finally the deployment plan is built using <code>build</code> method. Note the location of archive may be different in your environment.</p>
</li>
<li>
<p>Finally the deployment plan is executed using <code>execute</code> method.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Perform the deployment by running the test as:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>mvn test</code></pre>
</div>
</div>
</li>
<li>
<p>Check the server log to ensure that the application is deployed. The following server log entries should be visible:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>14:08:57,052 INFO  [org.wildfly.extension.undertow] (MSC service thread 1-9) JBAS017534: Register web context: /javaee7-1.0-SNAPSHOT
14:08:57,063 INFO  [org.jboss.as.server] (management-handler-thread - 17) JBAS018559: Deployed "javaee7-1.0-SNAPSHOT.war" (runtime-name : "javaee7-1.0-SNAPSHOT.war")</code></pre>
</div>
</div>
<div class="paragraph">
<p>You may see the error message as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>JBAS014616: Operation ("add") failed - address: ([("deployment" =&gt; "javaee7-1.0-SNAPSHOT.war")]) - failure description: "JBAS014803: Duplicate resource [(\"deployment\" =&gt; \"javaee7-1.0-SNAPSHOT.war\")]"</code></pre>
</div>
</div>
<div class="paragraph">
<p>This occurs if the archive has been previously deployed.</p>
</div>
</li>
</ol>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<code>addDeploy</code> method may be replaced with <code>andReplace("javaee7-1.0-SNAPSHOT.war")</code> to replace a previously deployed archive.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_ruby_tbd">2.7. Ruby (TBD)</h3>
<div class="paragraph">
<p>Send a pull request ?</p>
</div>
</div>
<div class="sect2">
<h3 id="_perl_tbd">2.8. Perl (TBD)</h3>
<div class="paragraph">
<p>Send a pull request ?</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="jboss-cli">3. Management using Command Line Interface (jboss-cli)</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Purpose</strong>: This section explains how to manage WildFly using jboss-cli.</p>
</div>
<div class="paragraph">
<p>WildFly comes with a Command Line Interface management tool for a standalone server or a managed domain. This script is in the <code>bin</code> directory of WildFly distrbution and can be invoked by calling <code>jboss-cli.sh</code> for Mac/Linux based systems or <code>jboss-cli.bat</code> for Windows. It allows a user to connect to a standalone server or domain controller and execute management operations available through the management model.</p>
</div>
<div class="sect2">
<h3 id="_connecting_to_a_server">3.1. Connecting to a server</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Start a WildFly standalone server, if not already running, using the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>standalone.sh</code></pre>
</div>
</div>
</li>
<li>
<p>Use &#8216;jboss-cli&#8217; to connect with this instance by giving the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>jboss-cli.sh -c</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>-c</code> switch connects using the default host (&#8216;localhost&#8217;) and management port (&#8216;9990&#8217;). These values are specified in &#8216;bin/jboss-cli.xml&#8217; and can be updated.</p>
</div>
<div class="paragraph">
<p>This opens up the &#8216;jboss-cli&#8217; interactive console and shows the following prompt:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>[standalone@localhost:9990 /]</code></pre>
</div>
</div>
<div class="paragraph">
<p>The prompt indicates that &#8216;jboss-cli&#8217; is connected to a standalone instance&#8217;s default management port.</p>
</div>
</li>
<li>
<p>If WildFly instance is running on a different host and/or port, then <code>--controller</code> switch can be used to specify that information.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>In another shell, start another WildFly instance on a different port using the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>./bin/standalone.sh -Djboss.socket.binding.port-offset=10000</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will start another WildFly standalone instance on application port 18080 and management port 19090.</p>
</div>
</li>
<li>
<p>Use &#8216;jboss-cli&#8217; to connect with this instance by giving the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>jboss-cli.sh -c --controller=localhost:19990</code></pre>
</div>
</div>
<div class="paragraph">
<p>This opens up the &#8216;jboss-cli&#8217; interactive console and shows the following prompt:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>[standalone@localhost:19990 /]</code></pre>
</div>
</div>
<div class="paragraph">
<p>The prompt indicates that &#8216;jboss-cli&#8217; is connected to a standalone instance on port &#8216;19990&#8217;.</p>
</div>
</li>
<li>
<p>Type &#8216;exit&#8217; or &#8216;quit&#8217; in the console to exit.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_resources_operations_and_commands">3.2. Resources, Operations, and Commands</h3>
<div class="paragraph">
<p>WildFly internal management model consists of <em>management resources</em> that that are added, removed, or modified by using <em>operations</em> and <em>commands</em>. Operations are low level but a comprehensive way to manage the server. Commands are more user-friendly, although most of them still translate into operation requests and some of them even into a few composite operation requests.</p>
</div>
<div class="paragraph">
<p>All resources are organized in a tree. The path to the node in the tree for a particular resource is its <em>address</em> and is identified by <code>/</code>.</p>
</div>
<div class="paragraph">
<p>Each resource expose information about their state as <em>attributes</em>.</p>
</div>
<div class="paragraph">
<p>Each resource may support child resources.</p>
</div>
<div class="paragraph">
<p>All resources expose metadata that describes their attributes, operations, and child types. This metadata can be queried by invoking one or more of the <em>global operations</em> supported by the resource.</p>
</div>
<div class="paragraph">
<p>Command and operation request history is enabled by default. While in the command line session, you can use the arrow keys to go back and forth in the history of commands and operations.</p>
</div>
<div class="sect3">
<h4 id="_operations">3.2.1. Operations</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The operations require one of the following prefixes:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><code>:</code> to execute against the current node</p>
<div class="paragraph">
<p>Type <code>:</code> at the prompt and press tab key to see a complete list of operations. This will show the following output:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>[standalone@localhost:9990 /] :
add-namespace                read-operation-names         take-snapshot
add-schema-location          read-resource                undefine-attribute
delete-snapshot              read-resource-description    upload-deployment-bytes
full-replace-deployment      reload                       upload-deployment-stream
list-snapshots               remove-namespace             upload-deployment-url
read-attribute               remove-schema-location       validate-address
read-children-names          replace-deployment           validate-operation
read-children-resources      resolve-expression           whoami
read-children-types          resolve-internet-address     write-attribute
read-config-as-xml           server-set-restart-required
read-operation-description   shutdown</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
Operations can be auto completed by using the tab key. For example, type <code>:r</code> at the prompt and press tab key to see the list of operations beginning with that letter.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Read a simple attribute using <code>read-attribute</code> operation as shown:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>[standalone@localhost:9990 /] :read-attribute(name=release-version)</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will show the output as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>{
    "outcome" =&gt; "success",
    "result" =&gt; "8.0.0.Final-SNAPSHOT"
}</code></pre>
</div>
</div>
</li>
<li>
<p><code>./</code> to execute against a child node of the current path</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>[standalone@localhost:9990 deployment] ./javaee7-1.0-SNAPSHOT.war:read-resource</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command reads resource&#8217;s attribute, the deployed war file in this case, values along with either basic (default) or complete information about any child resources. Detailed information about the resource can be obtained by adding <code>recursive=true</code> parameters as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>[standalone@localhost:9990 /deployment] ./javaee7-1.0-SNAPSHOT.war:read-resource(recursive=true)</code></pre>
</div>
</div>
</li>
<li>
<p><code>/</code> to execute an operation against the root node</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>[standalone@localhost:9990 /] /socket-binding-group=standard-sockets/socket-binding=http:read-attribute(name=bound-port)</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command traverses a path and reads an attribute on the leaf node. In this case it reads the port and displays the output as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>{
    "outcome" =&gt; "success",
    "result" =&gt; 8080
}</code></pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Read the complete list of operations supported by a resource by typing <code>read-operation-names</code> at the prompt and see the output as:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>[standalone@localhost:9990 /] :read-operation-names
{
    "outcome" =&gt; "success",
    "result" =&gt; [
        "add-namespace",
        "add-schema-location",
        "delete-snapshot",
        "full-replace-deployment",
        "list-snapshots",
        "read-attribute",
        "read-children-names",
        "read-children-resources",
        "read-children-types",
        "read-config-as-xml",
        "read-operation-description",
        "read-operation-names",
        "read-resource",
        "read-resource-description",
        "reload",
        "remove-namespace",
        "remove-schema-location",
        "replace-deployment",
        "resolve-expression",
        "resolve-internet-address",
        "server-set-restart-required",
        "shutdown",
        "take-snapshot",
        "undefine-attribute",
        "upload-deployment-bytes",
        "upload-deployment-stream",
        "upload-deployment-url",
        "validate-address",
        "validate-operation",
        "whoami",
        "write-attribute"
    ]
}</code></pre>
</div>
</div>
</li>
<li>
<p>A number of operations can be applied to every resource. Such operations are called <em>global operations</em>. <code>read-operation-names</code> is one such global operation. Another commonly used global operation is <code>read-resource</code> that reads resource&#8217;s attribute values along with either basic or complete information about any child resources.</p>
</li>
<li>
<p>Read complete detail about <code>read-operation-description</code> operation by giving the command:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>[standalone@localhost:9990 /] :read-operation-description(name=read-operation-names)</code></pre>
</div>
</div>
<div class="paragraph">
<p>and see the output as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>{
    "outcome" =&gt; "success",
    "result" =&gt; {
        "operation-name" =&gt; "read-operation-names",
        "description" =&gt; "Gets the names of all the operations for the given resource",
        "request-properties" =&gt; {"access-control" =&gt; {
            "type" =&gt; BOOLEAN,
            "description" =&gt; "If 'true' only operations the user is allowed to see are returned, and filtered operations are listed in the 'access-control' response header.",
            "expressions-allowed" =&gt; false,
            "required" =&gt; false,
            "nillable" =&gt; true,
            "default" =&gt; false
        }},
        "reply-properties" =&gt; {
            "type" =&gt; LIST,
            "value-type" =&gt; STRING,
            "description" =&gt; "The operation names"
        },
        "read-only" =&gt; true
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Try this operation for some other operations and read the output.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_commands">3.2.2. Commands</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Type <code>help --commands</code> at the jboss-cli prompt to see a complete list of commands available in current context. This will show the following output:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>[standalone@localhost:9990 /] help --commands
alias               deploy              if                  read-attribute      undeploy
batch               deployment-info     jdbc-driver-info    read-operation      unset
cd                  deployment-overlay  ls                  reload              version
clear               echo                module              run-batch           xa-data-source
command             echo-dmr            patch               set                 :
connect             help                pwd                 shutdown
data-source         history             quit                try</code></pre>
</div>
</div>
<div class="paragraph">
<p>This can also be achieved by pressing the tab key at the prompt. The list of commands depends upon the current context, i.e. it may change based upon the node address in the domain management model.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
Commands can be auto completed by using the tab key. For example, type letter <code>d</code> at the prompt and press tab key to see the list of commands beginning with that letter. Enter space after choosing the command and press tab key again to see the list of arguments to the command.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Help for any command is available by typing the command name and using <code>--help</code> option. For example:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>[standalone@localhost:9990 /] deploy --help</code></pre>
</div>
</div>
<div class="paragraph">
<p>will show the following output:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>SYNOPSIS

    deploy ((file_path | --url=deployment_url)
               [--script=script_name] [--name=deployment_name]
               [--runtime-name=deployment_runtime_name]
               [--force | --disabled] [--unmanaged])
           | --name=deployment_name
           [--server-groups=group_name (,group_name)* | --all-server-groups]
           [--headers={operation_header (;operation_header)*}]

DESCRIPTION

  Deploys the application designated by the file_path or enables an already
  existing but disabled in the repository deployment designated by the name
  . . .</code></pre>
</div>
</div>
</li>
<li>
<p><code>ls</code> command list the contents of a node path including node types and attributes. Giving this command on the root node shows the following output:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>[standalone@localhost:9990 /] ls
core-service                          management-minor-version=0
deployment                            name=aruns-macbook-pro
deployment-overlay                    namespaces=[]
extension                             process-type=Server
interface                             product-name=undefined
path                                  product-version=undefined
socket-binding-group                  profile-name=undefined
subsystem                             release-codename=WildFly
system-property                       release-version=8.0.0.Final-SNAPSHOT
launch-type=STANDALONE                running-mode=NORMAL
management-major-version=2            schema-locations=[]
management-micro-version=0            server-state=running</code></pre>
</div>
</div>
<div class="paragraph">
<p>All entries with name/value pairs are attributes and every thing else is a node.</p>
</div>
</li>
<li>
<p><code>cd</code> command changes the current node path to the specified argument.</p>
<div class="paragraph">
<p>Change the path to &#8216;management&#8217; node by typing the command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>[standalone@localhost:9990 /] cd core-service=management
[standalone@localhost:9990 core-service=management]</code></pre>
</div>
</div>
<div class="paragraph">
<p>The command line prompt in the first line shows that the command was issued from the root node. The prompt in the second line shows the updated node name.</p>
</div>
</li>
<li>
<p>Deploy an application and check its status by typing the following commands:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>[standalone@localhost:9990 /] deploy ~/workspaces/wildfly-lab/samples/javaee7/target/javaee7-1.0-SNAPSHOT.war --force
[standalone@localhost:9990 /] deployment-info
NAME                     RUNTIME-NAME             PERSISTENT ENABLED STATUS
javaee7-1.0-SNAPSHOT.war javaee7-1.0-SNAPSHOT.war true       true    OK</code></pre>
</div>
</div>
</li>
<li>
<p>Change the HTTP application port from a default value of 8080 to 8090 by giving the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>[standalone@localhost:9990 /] /socket-binding-group=standard-sockets/socket-binding=http:write-attribute(name=port,value=8090)</code></pre>
</div>
</div>
<div class="paragraph">
<p>and see the output as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>{
    "outcome" =&gt; "success",
    "response-headers" =&gt; {
        "operation-requires-reload" =&gt; true,
        "process-state" =&gt; "reload-required"
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The command output indicates that the server should be reloaded. This can be achieved by typing <code>reload</code> command at the prompt.
Now the application is accessible at <a href="http://8090/javaee7-1.0-SNAPSHOT/EmployeeList">http://8090/javaee7-1.0-SNAPSHOT/EmployeeList</a> instead of the port 8080.</p>
</div>
<div class="paragraph">
<p>Any change to the management model is persisted to the configuration file. Lets change the port back to 8080 by giving the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>[standalone@localhost:9990 /] /socket-binding-group=standard-sockets/socket-binding=http:write-attribute(name=port,value=8080)</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_batch">3.3. Batch</h3>
<div class="paragraph">
<p>The batch mode allows one to group commands and operations and execute them together as an atomic unit, i.e., if at least one of the commands or operations fails, all the other successfully executed commands and operations in the batch are rolled back.</p>
</div>
<div class="paragraph">
<p>Only the commands that translate into operation requests are allowed in the batch. The batch, actually, translates into a <em>composite</em> operation request.</p>
</div>
<div class="paragraph">
<p>Batch mode can be composed interactively using jboss-cli prompt or non-interactively where the set of commands and operations are saved in a file and loaded at the prompt.</p>
</div>
<div class="sect3">
<h4 id="_interactive_batch">3.3.1. Interactive Batch</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Start batch mode by typing the <code>batch</code> command:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>[standalone@localhost:9990 /] batch
[standalone@localhost:9990 / #]</code></pre>
</div>
</div>
<div class="paragraph">
<p>The prompt changes to <code>#</code> indicating that the CLI is in batch mode.</p>
</div>
</li>
<li>
<p>Enter the operations and commands that need to be included in batch:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>[standalone@localhost:9990 / #] data-source add --name=myDataSource --jndi-name=java:jboss/datasources/MyDataSource --user-name=sa --password=sa --driver-name=h2 --connection-url=jdbc:h2:mem:myData
[standalone@localhost:9990 / #] deploy ~/workspaces/wildfly-lab/samples/javaee7/javaee7-1.0-SNAPSHOT.war</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command is creating a JDBC resource and deploys an application that uses it.</p>
</div>
</li>
<li>
<p>Finally run the commands entered in the batch by giving the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>[standalone@localhost:9990 / #] run-batch</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the command is executed successfully then it is discarded and the CLI leaves the batch mode. If any of the command or operation in the batch fails then the CLI gives an error and all steps executed so far are rolled back.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_non_interactive_batch">3.3.2. Non-interactive Batch</h4>
<div class="paragraph">
<p>Non-interactive batch is useful for set of commands and operations that are executed frequently. Such commands and operations can be saved to a file and later used as argument to &#8216;batch&#8217; command.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Save the following commands in a text file:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>/subsystem=datasources/data-source="java:jboss/datasources/MyDataSource":add(jndi-name="java:jboss/datasources/MyDataSource", driver-name="h2", connection-url="jdbc:h2:mem:myData", user-name="sa", password="sa")
deploy ~/workspaces/wildfly-lab/samples/javaee7/target/javaee7-1.0-SNAPSHOT.war</code></pre>
</div>
</div>
<div class="paragraph">
<p>and save the file as &#8216;myScript.txt&#8217;.</p>
</div>
</li>
<li>
<p>Run the interactive CLI as:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>standalone.sh</code></pre>
</div>
</div>
</li>
<li>
<p>Load the script file using <code>batch</code> command:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>[standalone@localhost:9990 /] batch --file=myScript.txt</code></pre>
</div>
</div>
<div class="paragraph">
<p>+ Run the batch using the <code>run-job</code> command.</p>
</div>
<div class="paragraph">
<p>Alternatively, the file may be loaded and executed in one command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>[standalone@localhost:9990 /] run-batch --file=myScript.txt</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_environment_variables">3.4. Environment variables</h3>
<div class="paragraph">
<p>CLI supports variables and are resolved during command line parsing phase. They are useful to store frequently used nodepaths, complex commands or operations, or any other text that needs a shorter and easy to use name.</p>
</div>
<div class="paragraph">
<p>Variables set during a CLI session are not persisted when the session is terminated. The variables may be stored in <code>.jbossclirc</code> in which case they are persisted across different sessions.</p>
</div>
<div class="sect3">
<h4 id="_non_persistent_variables">3.4.1. Non-persistent Variables</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Set a new variable as:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>[standalone@localhost:9990 /] set default_port=/socket-binding-group=standard-sockets/socket-binding=http:read-attribute(name=bound-port)</code></pre>
</div>
</div>
<div class="paragraph">
<p>This code defines a new variable <code>default_port</code> and sets its value to the defined operation. Variable names are expected to follow Java identifier format.</p>
</div>
</li>
<li>
<p>Use this variable in CLI to execute the command:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>[standalone@localhost:9990 /] $default_port</code></pre>
</div>
</div>
<div class="paragraph">
<p>to see the output as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>{
    "outcome" =&gt; "success",
    "result" =&gt; 8090,
    "response-headers" =&gt; {"process-state" =&gt; "reload-required"}
}</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_persistent_variables">3.4.2. Persistent Variables</h4>
<div class="paragraph">
<p>Persistent variables are stored in <code>.jbossclirc</code> file. The location of this file is checked in the following order:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>value of system property <code>jboss.cli.rc</code></p>
</li>
<li>
<p>user&#8217;s working directory (as defined by <code>user.dir</code> system property)</p>
</li>
<li>
<p><code>bin</code> directory</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>A default <code>.jbossclirc</code> is already included in the <code>bin</code> directory and can be used as a template for user-specific environment setup.</p>
</div>
<div class="paragraph">
<p>The file contains &#8216;set&#8217; commands to define the variables, such as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>set default_port=/socket-binding-group=standard-sockets/socket-binding=http:read-attribute(name=bound-port)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_gui">3.5. GUI</h3>
<div class="paragraph">
<p>CLI can be started with a GUI instead of a command line. It allows you to browse through different nodes and commands and operations supported on a node. Commands are automatically created and can be submitted to the server. Applications can be deployed and undeployed as well.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Type the following command to start CLI with GUI:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>standalone.sh --gui</code></pre>
</div>
</div>
<div class="paragraph">
<p>The complete domain model is shown in a separate window as:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/jboss-cli-gui.png" alt="jboss cli gui">
</div>
<div class="title">Figure 8. jboss-cli GUI</div>
</div>
</li>
<li>
<p>Right-click on any node to see the list of supported operations as shown:</p>
<div class="imageblock">
<div class="content">
<img src="images/jboss-cli-gui-operations.png" alt="jboss cli gui operations">
</div>
<div class="title">Figure 9. Operations on nodes</div>
</div>
<div class="paragraph">
<p>The command is dynamically created and populated in the &#8216;cmd&gt;&#8217; text box.</p>
</div>
</li>
<li>
<p>This command can be submitted to the server by clicking on &#8216;Submit&#8217; button. Command output is shown:</p>
<div class="imageblock">
<div class="content">
<img src="images/jboss-cli-gui-output.png" alt="jboss cli gui output">
</div>
<div class="title">Figure 10. jboss-cli GUI output</div>
</div>
</li>
<li>
<p>Type &#8216;serv&#8217; in &#8216;Filter&#8217; box to search for any nodes and attributes that contains this phrase. The output is shown as:</p>
<div class="imageblock">
<div class="content">
<img src="images/jboss-cli-gui-filter.png" alt="jboss cli gui filter">
</div>
<div class="title">Figure 11. Filter on GUI</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_role_based_access_control">4. Role Based Access Control</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Role Based Access Control (RBAC) is the ability to restrict access to system or certain portions of it to authorized users. For JBoss AS 7.x, the web-based administrative console had an all-or-nothing approach. This means user authenticated with management security realm will have all the privileges. This may not be appropriate for mission-critical deployments and a finer-grained control may be required. WildFly 8 introduces RBAC using different roles.</p>
</div>
<div class="paragraph">
<p><strong>Purpose</strong>: This section explains how to configure and use RBAC for WildFly.</p>
</div>
<div class="paragraph">
<p>There are seven pre-defined roles in two different categories. First four roles are where users are locked out of sensitive data and the next three level roles where users are allowed to deal with sensitive data.</p>
</div>
<div class="paragraph">
<p>The pre-defined roles are explained below:</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 100%;">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Role</th>
<th class="tableblock halign-left valign-top">Permissions</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Monitor</p></td>
<td class="tableblock halign-left valign-top"><div><div class="ulist">
<ul>
<li>
<p>Has the fewest permissions</p>
</li>
<li>
<p>Can only read configuration and current runtime state</p>
</li>
<li>
<p>No access to sensitive resources or data or audit logging resources</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Operator</p></td>
<td class="tableblock halign-left valign-top"><div><div class="ulist">
<ul>
<li>
<p>All permissions of Monitor</p>
</li>
<li>
<p>Can modify the runtime state, e.g. reload or shutdown the server, pause/resume JMS destination, flush database connection pool.</p>
</li>
<li>
<p>Does not have permission to modify persistent state.</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maintainer</p></td>
<td class="tableblock halign-left valign-top"><div><div class="ulist">
<ul>
<li>
<p>All permissions of Operator</p>
</li>
<li>
<p>Can modify the persistent state, e.g. deploy an application, setting up new data sources, add a JMS destination</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Deployer</p></td>
<td class="tableblock halign-left valign-top"><div><div class="ulist">
<ul>
<li>
<p>All permissions of Maintainer</p>
</li>
<li>
<p>Permission is restricted to applications only, cannot make changes to container configuration</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Administrator</p></td>
<td class="tableblock halign-left valign-top"><div><div class="ulist">
<ul>
<li>
<p>All permissions of Maintainer</p>
</li>
<li>
<p>View and modify sensitive data such as access control system</p>
</li>
<li>
<p>No access to administrative audit logging system</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Auditor</p></td>
<td class="tableblock halign-left valign-top"><div><div class="ulist">
<ul>
<li>
<p>All permissions of Monitor</p>
</li>
<li>
<p>View and modify resources to administrative audit logging system</p>
</li>
<li>
<p>Cannot modify sensitive resources or data outside auditing, can read any sensitive data</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Super User</p></td>
<td class="tableblock halign-left valign-top"><div><div class="ulist">
<ul>
<li>
<p>Has all the permissions</p>
</li>
<li>
<p>Equivalent to administrator in previous versions</p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
<div class="sect2">
<h3 id="_default_super_user">4.1. Default super user</h3>
<div class="paragraph">
<p>By default, any user added to the management realm and not belonging to a group is in &#8220;Super User&#8221; role.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Start the server as standalone instance if not already running:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>./bin/standalone.sh</code></pre>
</div>
</div>
</li>
<li>
<p>Access Admin Console at <a href="http://localhost:9990/console">http://localhost:9990/console</a>. This prompts for authentication as shown:</p>
<div class="imageblock">
<div class="content">
<img src="images/rbac-authentication-required.png" alt="rbac authentication required">
</div>
<div class="title">Figure 12. Authentication for Admin Console</div>
</div>
<div class="paragraph">
<p>Enter the user name &#8216;sheldon&#8217; and password &#8216;bazinga&#8217; (as created earlier). Admin console should look like:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/rbac-admin-console-superuser-default.png" alt="rbac admin console superuser default">
</div>
<div class="title">Figure 13. Super user default view</div>
</div>
<div class="paragraph">
<p>This view shows:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>A new &#8216;Administration&#8217; tab that allows to map users to roles. This will be done in a later section.</p>
</li>
<li>
<p>Information about the logged in user is shown on top-right as:</p>
<div class="imageblock">
<div class="content">
<img src="images/rbac-superuser-information.png" alt="rbac superuser information">
</div>
<div class="title">Figure 14. Super user menu</div>
</div>
<div class="paragraph">
<p>Notice the logged in user name is shown.</p>
</div>
</li>
<li>
<p>A user in &#8216;Super User&#8217;' role can act to run in any role by clicking on &#8216;Run as&#8217;. Click on &#8216;Run as&#8217; and select drop-down list box to see the list of available roles as:</p>
<div class="imageblock">
<div class="content">
<img src="images/rbac-run-as-roles.png" alt="rbac run as roles">
</div>
<div class="title">Figure 15. Run as roles</div>
</div>
</li>
<li>
<p>Select the &#8216;Monitor&#8217; role and click on &#8216;Run As&#8217;.</p>
<div class="paragraph">
<p>The application has to be reloaded for changes to take effect. Click on &#8216;Confirm&#8217; to reload the application. After the reload, clicking on the user on top-right in admin console will display the selected role as &#8216;Run as Monitor&#8217; as shown:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/rbac-run-as-monitor.png" alt="rbac run as monitor">
</div>
<div class="title">Figure 16. Run as monitor</div>
</div>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Click on &#8216;Manage Deployments&#8217; and check that &#8216;Add&#8217;, &#8216;Remove&#8217;, and similar buttons are not present as shown:</p>
<div class="imageblock">
<div class="content">
<img src="images/rbac-run-as-monitor-deployments.png" alt="rbac run as monitor deployments">
</div>
<div class="title">Figure 17. Manage deployments as monitor</div>
</div>
</li>
<li>
<p>Click on &#8216;Profile&#8217;, &#8216;Data Sources&#8217; and check that all data sources are visible but not editable. This is identified by the fact that &#8216;Add&#8217;, &#8216;Remove&#8217;, and &#8216;Disable&#8217; buttons are not available as shown.</p>
<div class="imageblock">
<div class="content">
<img src="images/rbac-run-as-monitor-data-sources.png" alt="rbac run as monitor data sources">
</div>
<div class="title">Figure 18. Data sources as monitor</div>
</div>
</li>
<li>
<p>Click on &#8216;Administration&#8217; tab and make sure the user does not have access to it as shown:</p>
<div class="imageblock">
<div class="content">
<img src="images/rbac-run-as-monitor-administration.png" alt="rbac run as monitor administration">
</div>
<div class="title">Figure 19. Administration as monitor</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Feel free to select other roles and observe how different options are enabled/disabled.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_configure_rbac_access_control_provider">4.2. Configure &#8216;rbac&#8217; access control provider</h3>
<div class="paragraph">
<p>WildFly 8 comes with two access control providers:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>&#8216;simple&#8217; provider, the default one, gives all privileges to any authenticated administrator. This provides compatibility with older releases.</p>
</li>
<li>
<p>&#8216;rbac&#8217; provider allows you to setup configuration that will map users to different roles.</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Configure &#8216;rbac&#8217; access control provider by giving the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>jboss-cli.sh -c --command="/core-service=management/access=authorization:write-attribute(name=provider,value=rbac)"</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command will change authorization provider to &#8220;rbac&#8221; and will produce the output as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>{
    "outcome" =&gt; "success",
    "response-headers" =&gt; {
        "operation-requires-reload" =&gt; true,
        "process-state" =&gt; "reload-required"
    }
}</code></pre>
</div>
</div>
</li>
<li>
<p>The server needs to be restarted as the authorization provider is changed. Give the following command to restart the server:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>./bin/jboss-cli.sh -c --command="reload"</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
If the server is running in managed domain then it can be restarted by additionally specifying <code>--host=master</code> in the command.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Check the server log to confirm server restarted, look for specific time stamps.</p>
</div>
</li>
<li>
<p>Any existing roles need to be explicitly mapped after the access control provider is changed. Map the user &#8216;sheldon&#8217; to the role &#8216;Super User&#8217; by giving the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>jboss-cli.sh -c --command="/core-service=management/access=authorization/role-mapping=SuperUser/include=user-sheldon:add(name=sheldon,type=USER)"</code></pre>
</div>
</div>
</li>
<li>
<p>On top-right in admin console, click on the username and click on &#8216;Logout&#8217; and then &#8216;Confirm&#8217;.</p>
</li>
<li>
<p>Enter the login credentials again (username is &#8216;sheldon&#8217; and password is &#8216;bazinga&#8217;) to login back into the admin console.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_map_users_groups_and_roles">4.3. Map users, groups, and roles</h3>
<div class="paragraph">
<p>WildFly introduces the concept of &#8220;groups&#8221; in security realms. Users can be directly associated with a role, or can belong to a group and then a group can be associated with a role.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Add two users in different groups using <code>bin/adduser.sh</code> script</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Add first user in a group by giving the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>add-user.sh -u penny -p penny1 -g just4fun
Added user 'penny' to file '/Users/arungupta/workspaces/wildfly/build/target/wildfly-8.0.0.Final-SNAPSHOT/standalone/configuration/mgmt-users.properties'
Added user 'penny' to file '/Users/arungupta/workspaces/wildfly/build/target/wildfly-8.0.0.Final-SNAPSHOT/domain/configuration/mgmt-users.properties'
Added user 'penny' with groups just4fun to file '/Users/arungupta/workspaces/wildfly/build/target/wildfly-8.0.0.Final-SNAPSHOT/standalone/configuration/mgmt-groups.properties'
Added user 'penny' with groups just4fun to file '/Users/arungupta/workspaces/wildfly/build/target/wildfly-8.0.0.Final-SNAPSHOT/domain/configuration/mgmt-groups.properties'</code></pre>
</div>
</div>
</li>
<li>
<p>Add another user in a different group by giving the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>add-user.sh -u leonard -p leonard1 -g geek
Added user 'leonard' to file '/Users/arungupta/workspaces/wildfly/build/target/wildfly-8.0.0.Final-SNAPSHOT/standalone/configuration/mgmt-users.properties'
Added user 'leonard' to file '/Users/arungupta/workspaces/wildfly/build/target/wildfly-8.0.0.Final-SNAPSHOT/domain/configuration/mgmt-users.properties'
Added user 'leonard' with groups geek to file '/Users/arungupta/workspaces/wildfly/build/target/wildfly-8.0.0.Final-SNAPSHOT/standalone/configuration/mgmt-groups.properties'
Added user 'leonard' with groups geek to file '/Users/arungupta/workspaces/wildfly/build/target/wildfly-8.0.0.Final-SNAPSHOT/domain/configuration/mgmt-groups.properties'</code></pre>
</div>
</div>
<div class="paragraph">
<p>These commands creates the following users:</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 50%;">
<colgroup>
<col style="width: 33%;">
<col style="width: 33%;">
<col style="width: 33%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">User</th>
<th class="tableblock halign-left valign-top">Password</th>
<th class="tableblock halign-left valign-top">Group</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">penny</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">penny1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">just4fun</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">leonard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">leonard1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">geek</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Both users are added for standalone instance and managed domain.</p>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Click on &#8216;Administration&#8217; tab to see an output as:</p>
<div class="imageblock">
<div class="content">
<img src="images/rbac-admin-users-default.png" alt="rbac admin users default">
</div>
<div class="title">Figure 20. Administration tab in admin console</div>
</div>
<div class="paragraph">
<p>Previously assigned user/role mapping is already shown here.</p>
</div>
</li>
<li>
<p>Click on &#8216;Add&#8217; to assign a new role to user mapping. Type &#8216;penny&#8217; in &#8216;User&#8217; textbox and select &#8216;Monitor&#8217; role as shown:</p>
<div class="imageblock">
<div class="content">
<img src="images/rbac-admin-users-penny.png" alt="rbac admin users penny">
</div>
<div class="title">Figure 21. Assigning role to Penny</div>
</div>
<div class="paragraph">
<p>Click on &#8216;Save&#8217;.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Multiple roles may be assigned to each user.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Assign &#8216;Administrator&#8217; role to user &#8216;leonard&#8217;. The updated admin console looks like as shown:</p>
<div class="imageblock">
<div class="content">
<img src="images/rbac-admin-users-role-assigned.png" alt="rbac admin users role assigned">
</div>
<div class="title">Figure 22. Roles assigned to users</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
Groups, and thus all users in that group, can be assigned one or more roles by clicking on &#8216;GROUPS&#8217; tab.
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_logging_in_as_different_users">4.4. Logging in as different users</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click on top-right and select &#8216;Logout&#8217; to log out of admin console. Login again by using the username &#8216;penny&#8217; and password &#8216;penny1&#8217;. Note that this user was assigned &#8216;Monitor&#8217; role.</p>
</li>
<li>
<p>Top-right of admin console shows the logged in user name.</p>
<div class="imageblock">
<div class="content">
<img src="images/rbac-penny-information.png" alt="rbac penny information">
</div>
<div class="title">Figure 23. Information about Penny</div>
</div>
<div class="paragraph">
<p>Note that &#8216;Run as&#8217; is not available any more.</p>
</div>
</li>
<li>
<p>Click on &#8216;Manage Deployments&#8217; to see the output as shown:</p>
<div class="imageblock">
<div class="content">
<img src="images/rbac-run-as-monitor-deployments.png" alt="rbac run as monitor deployments">
</div>
<div class="title">Figure 24. Deployments for user Penny</div>
</div>
<div class="paragraph">
<p>This role permits only monitoring and &#8216;Add&#8217;, &#8216;Remove&#8217;, &#8216;En/Disable&#8217;, and &#8216;Replace&#8217; buttons are not available.</p>
</div>
</li>
<li>
<p>Click on &#8216;Administration&#8217; tab to see a permissiond denied output as:</p>
<div class="imageblock">
<div class="content">
<img src="images/rbac-run-as-monitor-administration.png" alt="rbac run as monitor administration">
</div>
<div class="title">Figure 25. Administration for user Penny</div>
</div>
</li>
<li>
<p>Click on top-right and select &#8216;Logout&#8217; to log out of admin console. Login again by using the username &#8216;leonard&#8217; and password &#8216;leonard1&#8217;. Note that this user was assigned &#8216;Administrator&#8217; role.</p>
</li>
<li>
<p>Top-right of admin console shows the logged in user name.</p>
<div class="imageblock">
<div class="content">
<img src="images/rbac-leonard-information.png" alt="rbac leonard information">
</div>
<div class="title">Figure 26. Information about Leonard</div>
</div>
<div class="paragraph">
<p>Note that &#8216;Run as&#8217; is not available any more.</p>
</div>
</li>
<li>
<p>Click on &#8216;Deployments&#8217; and confirm that new deployments can be added or existing can be replace, removed, enabled or disabled by the presence of buttons.</p>
</li>
<li>
<p>Click on &#8216;Administration&#8217; tab and confirm that all information is visible and editable.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_filtering_out_commands_in_jboss_cli">4.5. Filtering out commands in &#8216;jboss-cli&#8217;</h3>
<div class="paragraph">
<p>CLI or &#8216;jboss-cli&#8217; can authenticate against local WildFly without prompting the user for a username and password. This mechanism only works if the user running the CLI has read access to the &#8220;standalone/tmp/auth&#8221; directory or &#8220;domain/tmp/auth&#8221; folder under the respective WildFly installation. If the local mechanism fails then the CLI will fallback to prompting for a username and password.</p>
</div>
<div class="paragraph">
<p>Alternatively authentication can be forced by explicitly specifying <code>user</code> and <code>password</code> options.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Connect using &#8216;jboss-cli&#8217; using the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>jboss-cli.sh --user=penny --password=penny1 -c</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the user &#8216;penny&#8217; is in Monitor role.</p>
</div>
</li>
<li>
<p>Type <code>data-source</code> on the CLI console and TAB to see the following output:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>[standalone@localhost:9990 /] data-source
--help                               flush-gracefully-connection-in-pool
--name=                              flush-idle-connection-in-pool
add                                  flush-invalid-connection-in-pool
disable                              read-resource
enable                               remove
flush-all-connection-in-pool         test-connection-in-pool</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that all commands and attributes, even those not permitted for Monitor role, are shown.</p>
</div>
</li>
<li>
<p>Try to add a new data source using the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>[standalone@localhost:9990 /] data-source add --name=testDataSource</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command gives the following error:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>JBAS013456: Unauthorized to execute operation 'add' for resource '[
    ("subsystem" =&gt; "datasources"),
    ("data-source" =&gt; "testDataSource")
]' -- "JBAS013475: Permission denied"</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is because &#8216;Monitor&#8217; role does not have permission to add data sources.</p>
</div>
</li>
<li>
<p>Type <code>exit</code> or <code>quit</code> to exit out of CLI console.</p>
</li>
<li>
<p>Edit <code>bin/jboss-cli.xml</code> and change the following element:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&lt;access-control&gt;false&lt;/access-control&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>to</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&lt;access-control&gt;true&lt;/access-control&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This element filter out the command and attribute suggestions displayed based on user&#8217;s permissions.</p>
</div>
</li>
<li>
<p>Connect using &#8216;jboss-cli&#8217; using the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>./bin/jboss-cli.sh --user=penny --password=penny1 -c</code></pre>
</div>
</div>
</li>
<li>
<p>Type <code>data-source</code> on the CLI console and TAB to see the following output:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>[standalone@localhost:9990 /] data-source
--help         --name=        read-resource</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that only permitted commands and attributes are shown.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
Try some other commands and see which ones are accessible or not.
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_audit_logging">5. Audit Logging</h2>
<div class="sectionbody">
<div class="paragraph">
<p>WildFly comes with audit logging built in for management operations affecting the management model. The audit log records can be logged to a file on the server or to syslog. Syslog is a better choice for audit logging since you can log to a remote syslog server, and secure the authentication to happen over TLS with client certificate authentication. This section will only cover default logging in file.</p>
</div>
<div class="sect2">
<h3 id="_turn_on_audit_logging">5.1. Turn on audit logging</h3>
<div class="paragraph">
<p>By default audit logging is turned off and needs to be turned on.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Connect using &#8216;jboss-cli&#8217; using the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>jboss-cli.sh --user=sheldon --password=bazinga -c</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note you need to provide user and password credentials of a user in Auditor or Super User role.</p>
</div>
</li>
<li>
<p>Enable audit logging by giving the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>[standalone@localhost:9990 /] /core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will display the output as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>{"outcome" =&gt; "success"}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the user is not in Auditor or Super User role then the following error message will be displayed:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>{
    "outcome" =&gt; "failed",
    "failure-description" =&gt; "JBAS013456: Unauthorized to execute operation 'write-attribute' for resource '[
    (\"core-service\" =&gt; \"management\"),
    (\"access\" =&gt; \"audit\"),
    (\"logger\" =&gt; \"audit-log\")
]' -- \"JBAS013475: Permission denied\"",
    "rolled-back" =&gt; true
}</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_logging_json_records_to_file">5.2. Logging JSON records to file</h3>
<div class="paragraph">
<p>By default audit log records are formatted using JSON and are generated in <code>standalone/data/audit-log.log</code>. This file is generated after audit log is enabled and looks like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>{
    "type" : "core",
    "r/o" : false,
    "booting" : false,
    "version" : "8.0.0.Final-SNAPSHOT",
    "user" : "sheldon",
    "domainUUID" : null,
    "access" : "NATIVE",
    "remote-address" : "127.0.0.1/127.0.0.1",
    "success" : true,
    "ops" : [{
        "address" : [
            {
                "core-service" : "management"
            },
            {
                "access" : "audit"
            },
            {
                "logger" : "audit-log"
            }
        ],
        "operation" : "write-attribute",
        "name" : "enabled",
        "value" : true,
        "operation-headers" : {
            "caller-type" : "user",
            "access-mechanism" : "NATIVE"
        }
    }]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The main fields in this JSON record are explained below:</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 100%;">
<colgroup>
<col style="width: 16%;">
<col style="width: 83%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Field Name</th>
<th class="tableblock halign-left valign-top">Possible Values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>type</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="ulist">
<ul>
<li>
<p>&#8216;core&#8217; indicates it is a management operation</p>
</li>
<li>
<p>&#8216;jms&#8217; indicates it is from the jms subsystem</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>r/o</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="ulist">
<ul>
<li>
<p>&#8216;true&#8217; if the operation does not change the management model</p>
</li>
<li>
<p>&#8216;false&#8217; otherwise</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>booting</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="ulist">
<ul>
<li>
<p>&#8216;true&#8217; is the operation was executed during the bootup process</p>
</li>
<li>
<p>&#8216;false&#8217; otherwise</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>user</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The username of the authenticated user. If the operation is logged via the CLI on the same machine as the running server, then the special $local user is used</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>access</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="ulist">
<ul>
<li>
<p>&#8216;native&#8217; The operation came in through the native management interface, for example the CLI</p>
</li>
<li>
<p>&#8216;http&#8217; The operation came in through the domain HTTP interface, for example the admin console</p>
</li>
<li>
<p>&#8216;jmx&#8217; The operation came in through the JMX subsystem. See JMX for how to configure audit logging for JMX</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ops</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>List of operations being executed serialized to JSON</p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Try a few other management operations and notice how <code>audit-log.log</code> is updated. For example, trying to add a new data source using the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>[standalone@localhost:9990 /] data-source add --name=myDataSource2 --jndi-name=java:jboss/datasources/MyDataSource2 --user-name=sa --password=sa --driver-name=h2 --connection-url=jdbc:h2:mem:myData</code></pre>
</div>
</div>
<div class="paragraph">
<p>will generate the following audit log record:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>{
    "type" : "core",
    "r/o" : false,
    "booting" : false,
    "version" : "8.0.0.Final-SNAPSHOT",
    "user" : "sheldon",
    "domainUUID" : null,
    "access" : "NATIVE",
    "remote-address" : "127.0.0.1/127.0.0.1",
    "success" : true,
    "ops" : [{
        "address" : [
            {
                "subsystem" : "datasources"
            },
            {
                "data-source" : "myDataSource2"
            }
        ],
        "operation" : "add",
        "user-name" : "sa",
        "password" : "sa",
        "jndi-name" : "java:jboss/datasources/MyDataSource2",
        "connection-url" : "jdbc:h2:mem:myData",
        "driver-name" : "h2",
        "operation-headers" : {
            "caller-type" : "user",
            "access-mechanism" : "NATIVE"
        },
        "driver-class" : null,
        "datasource-class" : null,
        "new-connection-sql" : null,
        "url-delimiter" : null,
        "url-selector-strategy-class-name" : null,
        "use-java-context" : null,
        "jta" : null,
        "max-pool-size" : null,
        "min-pool-size" : null,
        "initial-pool-size" : null,
        "pool-prefill" : null,
        "pool-use-strict-min" : null,
        "capacity-incrementer-class" : null,
        "capacity-decrementer-class" : null,
        "security-domain" : null,
        "reauth-plugin-class-name" : null,
        "flush-strategy" : null,
        "allow-multiple-users" : null,
        "connection-listener-class" : null,
        "connection-properties" : null,
        "prepared-statements-cache-size" : null,
        "share-prepared-statements" : null,
        "track-statements" : null,
        "allocation-retry" : null,
        "allocation-retry-wait-millis" : null,
        "blocking-timeout-wait-millis" : null,
        "idle-timeout-minutes" : null,
        "query-timeout" : null,
        "use-try-lock" : null,
        "set-tx-query-timeout" : null,
        "transaction-isolation" : null,
        "check-valid-connection-sql" : null,
        "exception-sorter-class-name" : null,
        "stale-connection-checker-class-name" : null,
        "valid-connection-checker-class-name" : null,
        "background-validation-millis" : null,
        "background-validation" : null,
        "use-fast-fail" : null,
        "validate-on-match" : null,
        "spy" : null,
        "use-ccm" : null,
        "enabled" : null,
        "reauth-plugin-properties" : null,
        "exception-sorter-properties" : null,
        "stale-connection-checker-properties" : null,
        "valid-connection-checker-properties" : null,
        "connection-listener-property" : null,
        "capacity-incrementer-properties" : null,
        "capacity-decrementer-properties" : null
    }]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Similarly deploying an application as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>[standalone@localhost:9990 /] deploy javaee7-1.0-SNAPSHOT.war --force</code></pre>
</div>
</div>
<div class="paragraph">
<p>shows the following audit log record:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>{
    "type" : "core",
    "r/o" : false,
    "booting" : false,
    "version" : "8.0.0.Final-SNAPSHOT",
    "user" : "sheldon",
    "domainUUID" : null,
    "access" : "NATIVE",
    "remote-address" : "127.0.0.1/127.0.0.1",
    "success" : true,
    "ops" : [{
        "operation" : "full-replace-deployment",
        "name" : "javaee7-1.0-SNAPSHOT.war",
        "content" : [{"input-stream-index" : 0}],
        "operation-headers" : {
            "caller-type" : "user",
            "access-mechanism" : "NATIVE"
        },
        "address" : null
    }]
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_acknowledgements">6. Acknowledgements</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following JBoss community members graciously reviewed and contributed to this hands-on lab:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Jorge Solórzano (twitter handle ?)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Thank you very much for providing the valuable feedback!</p>
</div>
<div class="paragraph">
<p>Please send pull requests at <a href="http://github.com/arun-gupta/wildfly-lab">http://github.com/arun-gupta/wildfly-lab</a> to contribute or file issues.</p>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 1.0<br>
Last updated 2014-01-29 16:22:44 IST
</div>
</div>
</body>
</html>